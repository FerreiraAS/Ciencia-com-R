# **Análise exploratória de dados** {#analise-exploratoria}

<br>

## Análise exploratória de dados

<br>

### O que é análise exploratória de dados?

-   Análise exploratória de dados consiste em um processo iterativo de elaboração e interpretação da síntese de dados, tabelas e gráficos, considerando os aspectos teóricos do estudo.[@Ferketich1986]

-   Análise exploratória deve ser separada da análise inferencial de testes de hipóteses; a decisão sobre os modelos a testar deve ser feita *a priori*.[@zuur2009]

<br>

### Quais são os objetivos centrais da análise exploratória de dados?

-   A análise exploratória de dados (EDA) tem dois objetivos principais: (a) descrição dos dados e (b) formulação de modelos. A descrição envolve resumir os dados e destacar características essenciais, enquanto a formulação de modelos auxilia na geração de hipóteses e na escolha de procedimentos estatísticos adequados.[@chatfield1986]

<br>

### Por que conduzir a análise exploratória de dados?

-   A condução de análise exploratória de dados pode ajudar a identificar padrões e pode orientar trabalhos futuros, mas os resultados não devem ser interpretados como inferências sobre uma população.[@zuur2009]

-   A análise exploratória não deve ser usada para definir as questões e hipóteses científicas do estudo.[@zuur2009]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *explore*[@explore] fornece a função [*explore*](https://www.rdocumentation.org/packages/explore/versions/1.0.2/topics/explore) para análise exploratória de um banco de dados.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *dataMaid*[@dataMaid] fornece a função [*makeDataReport*](https://www.rdocumentation.org/packages/dataMaid/versions/1.4.1/topics/makeDataReport) para criar um relatório de análise exploratória de um banco de dados.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *DataExplorer*[@DataExplorer] fornece a função [*create_report*](https://www.rdocumentation.org/packages/DataExplorer/versions/0.8.2/topics/create_report) para criar um relatório de análise exploratória de um banco de dados.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *SmartEDA*[@SmartEDA] fornece a função [*ExpReport*](https://www.rdocumentation.org/packages/SmartEDA/versions/0.3.9/topics/ExpReport) para criar um relatório de análise exploratória de um banco de dados.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *gtExtras*[@gtExtras] fornece a função [*gt_plt_summary*](https://www.rdocumentation.org/packages/gtExtras/versions/0.5.0/topics/gt_plt_summary) para criar uma tabela descritiva síntese com histogramas ou gráficos de barra a partir de um banco de dados.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *radiant*[@radiant] fornece a função [*radiant*](https://www.rdocumentation.org/packages/radiant/versions/1.5.0/topics/radiant) para executar uma interface interativa para análise exploratória de dados.
:::

<br>

## Ingredientes da análise exploratória de dados

<br>

### Quais são os principais elementos que compõem a análise exploratória de dados?

-  Verificação da qualidade dos dados (erros, ausências, *outliers*), o cálculo de estatísticas descritivas (média, desvio-padrão, intervalos, correlações) e o uso de representações gráficas como histogramas, diagramas de dispersão, *boxplots* e gráficos de séries temporais.[@chatfield1986]

- Técnicas multivariadas exploratórias, como análise de componentes principais e análise de clusters, podem revelar padrões em dados complexos.[@chatfield1986]

<br>

### Quais etapas constituem a análise exploratória de dados?

-   Cada combinação de problema de pesquisa e delineamento de estudo pode demandar um plano de análise exploratório distinto.[@zuur2009]

-   Verifique a existência e/ou influência de valores discrepantes ("fora da curva" ou *outliers*):[@chatfield1986; @Ferketich1986; @zuur2009]

    -   Boxplots

    -   Gráficos quantil-quantil (Q-Q)

-   A análise exploratória valoriza o uso de gráficos interativos e técnicas de *brushing* e *linking*, que permitem explorar padrões ocultos, relacionar múltiplas variáveis e destacar subconjuntos de observações.[@behrens1997]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *ggplot2*[@ggplot2] fornece a função [*geom_boxplot*](https://www.rdocumentation.org/packages/ggplot2/versions/3.5.2/topics/geom_boxplot) para construção de gráficos *boxplot*.
:::

<br>

-   Verifique a homocedasticidade (homogeneidade da variância):[@zuur2009]

    -   Boxplots condicionais (por fator de análise)

    -   Análise dos resíduos do modelo de regressão

    -   Gráfico resíduos vs. valores ajustados

<br>

-   Verifique a normalidade da distribuição dos dados:[@chatfield1986; @zuur2009]

    -   Histograma das variáveis (por fator de análise)

    -   Histograma dos resíduos da regressão

<br>

-   Verifique a existência de grande quantidade de valores nulos (=0):[@zuur2009]

    -   Histograma das variáveis (por fator de análise)

<br>

-   Verifique a existência de colinearidade entre variáveis independentes de um modelo de regressão:[@zuur2009]

    -   Fator de inflação de variância (*variance inflation factor*, VIF)

    -   Coeficiente de correlação de Pearson ($r$)

    -   Gráfico de dispersão entre variáveis

<br>

-   Verifique possíveis relações entre as variáveis dependente(s) e independente(s) de um modelo de regressão:[@zuur2009]

    -   Gráfico de dispersão entre variáveis independente e dependente

<br>

-   Verifique possíveis interações entre as variáveis dependente(s) de um modelo de regressão:[@zuur2009]

    -   Gráfico *coplot* de dispersão entre variáveis dependentes

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *ggcleveland*[@ggcleveland] fornece a função [*gg_coplot*](https://www.rdocumentation.org/packages/ggcleveland/versions/0.1.0/topics/gg_coplot) para construção de gráficos *boxplot* condicionais.
:::

<br>

-   Verifique por dependência entre variáveis de um modelo de regressão:[@zuur2009]

    -   Gráfico de série temporal das variáveis

    -   Gráfico de autocorrelação entre as variáveis

<br>

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.cap= "Séries temporais e autocorrelação de duas séries simuladas com fraca e forte autocorrelação.", out.width='80%', fig.align='center'}
sim_ar1 <- function(n, phi = 0.8, mu = 0, sd = 1, x0 = 0) {
  e <- rnorm(n, 0, sd)
  x <- numeric(n)
  x[1] <- x0
  for (t in 2:n) x[t] <- mu + phi*(x[t-1] - mu) + e[t]
  x
}

acf_to_df <- function(x, lag.max = NULL) {
  a <- stats::acf(x, lag.max = lag.max, plot = FALSE, na.action = na.omit)
  n <- sum(!is.na(x))
  tibble::tibble(lag = as.integer(a$lag),
         acf = as.numeric(a$acf),
         ci  = 1.96 / sqrt(n)) |>
    dplyr::filter(lag >= 0)
}

plot_ts <- function(x, titulo = "Série temporal") {
  tibble::tibble(t = seq_along(x), y = x) |>
    ggplot2::ggplot(ggplot2::aes(t, y)) +
    ggplot2::geom_line() +
    ggplot2::labs(x = "Tempo", y = NULL, title = titulo) +
    ggplot2::theme_minimal(base_size = 12)
}

plot_acf <- function(x, titulo = "ACF", lag.max = 40) {
  acf_df <- acf_to_df(x, lag.max = lag.max)
  ggplot2::ggplot(acf_df, ggplot2::aes(lag, acf)) +
    ggplot2::geom_hline(yintercept = 0) +
    ggplot2::geom_ribbon(ggplot2::aes(ymin = -ci, ymax = ci), alpha = 0.15) +
    ggplot2::geom_segment(ggplot2::aes(xend = lag, yend = 0)) +
    ggplot2::labs(x = "Defasagem (lag)", y = "ACF", title = titulo) +
    ggplot2::theme_minimal(base_size = 12)
}

# Dados: fraca vs forte ACF
set.seed(123)
n <- 250
serie_fraca <- sim_ar1(n, phi = 0.10, sd = 1.0)  # fraca autocorrelação
serie_forte <- sim_ar1(n, phi = 0.90, sd = 1.0)  # forte autocorrelação

# Gráficos individuais
g_ts_fraca <- plot_ts(serie_fraca, "Série temporal — Fraca autocorrelação (φ = 0.10)")
g_ts_forte <- plot_ts(serie_forte, "Série temporal — Forte autocorrelação (φ = 0.90)")
g_acf_fraca <- plot_acf(serie_fraca, "ACF — Fraca autocorrelação", lag.max = 40)
g_acf_forte <- plot_acf(serie_forte, "ACF — Forte autocorrelação", lag.max = 40)

# Figura 2x2
library(patchwork)
fig_2x2 <- (g_ts_fraca | g_ts_forte) / (g_acf_fraca | g_acf_forte)
fig_2x2
```

<br>

-   Medidas como mediana, *trimean*, distância absoluta mediana e procedimentos de *winsorizing* ou *trimming* são preferidos, pois reduzem a influência de valores extremos e oferecem resumos mais fiéis.[@behrens1997]

-   A análise exploratória adota o esquema `dados = ajuste + resíduo`, no qual o analista ajusta modelos provisórios, examina resíduos e refina os modelos em ciclos sucessivos de aproximação.[@behrens1997]

-   Valores discrepantes (*outliers*) não devem ser ignorados; eles podem indicar erros de coleta ou fenômenos relevantes. *Fringeliers*, casos menos extremos mas recorrentes, também merecem atenção.[@behrens1997]

-   Transformar variáveis em novas formas (por exemplo, log ou inverso) pode revelar simetrias ocultas e tornar relações mais claras e lineares.[@behrens1997]

<br>

```{r, echo=FALSE, warning=FALSE, results='asis', eval=knitr::is_html_output()}
cat(readLines("citation.html"), sep = "\n")
```

<br>
