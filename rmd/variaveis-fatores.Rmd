# **Variáveis e fatores** {#variaveis-fatores}

<br>

## Variáveis

<br>

### O que são variáveis?

-   Variáveis são informações que podem variar entre medidas em diferentes indivíduos e/ou repetições.[@Altman1999]

-   Variáveis definem características de uma amostra extraída da população, tipicamente observados por aplicação de métodos de amostragem (isto é, seleção) da população de interesse.[@vetter2017]

<br>

### Como são classificadas as variáveis?

-   Quanto à informação:[@Ali2016; @vetter2017; @Dettori2018; @kaliyadan2019]

    -   Quantitativa

    -   Qualitativa

-   Quanto ao conteúdo:[@barkan2015; @Ali2016; @vetter2017; @Dettori2018; @kaliyadan2019]

    -   Contínua: representam ordem e magnitude entre valores.

        -   Contínua (números inteiros) vs. Discreta (números racionais).

        -   Intervalo (valor '0' é arbitrário) vs. Razão (valor '0' verdadeiro).

    -   Categórica ordinal (numérica ou nominal): representam ordem, mas não magnitude entre valores.

    -   Categórica nominal (multinominal ou dicotômica): não representam ordem ou magnitude, apenas categorias.

-   Quanto à interpretação:[@Ali2016; @vetter2017; @Dettori2018; @kaliyadan2019]

    -   Dependente (desfecho)

    -   Independente (preditora, covariável, confundidora, controle)

    -   Mediadora

    -   Moderadora

    -   Modificadora

    -   Auxiliar

    -   Indicadora

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *base*[@base] fornece a função [*class*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/class) para identificar qual é o tipo do objeto.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *base*[@base] fornece as funções [*as.numeric*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/numeric) e [*as.character*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/character) para criar objetos numéricos e categóricos, respectivamente.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *base*[@base] fornece as funções [*as.Date*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/as.Date) e [*as.logical*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/logical) para criar objetos em formato de data e lógicos (VERDADEIRO, FALSO), respectivamente.
:::

### Por que é importante classificar as variáveis?

-   Identificar corretamente os tipos de variáveis da pesquisa é uma das etapas da escolha dos métodos estatísticos adequados para as análises e representações no texto, tabelas e gráficos.[@Dettori2018]

<br>

## Transformação de variáveis

<br>

### O que é transformação de variáveis?

-   Transformação significa aplicar uma função matemática à variável medida em sua unidade original.[@Bland1996]

-   A transformação visa atender aos pressupostos dos modelos estatísticos quanto à distribuição da variável, em geral a distribuição gaussiana.[@Bland1996; @vetter2017]

-   A dicotomização pode ser interpretada como um caso particular de agrupamento.[@Fedorov2009]

<br>

### Por que transformar variáveis?

-   Muitos procedimentos estatísticos supõem que as variáveis - ou seus termos de erro, mais especificamente - são normalmente distribuídas. A violação dessa suposição pode aumentar suas chances de cometer um erro do tipo I ou II.[@osborne2010]

-   Mesmo quando se está usando análises consideradas robustas para violações dessas suposições ou testes não paramétricos (que não assumem explicitamente termos de erro normalmente distribuídos), atender a essas questões pode melhorar os resultados das análises (por exemplo, Zimmerman, 1995).[@osborne2010]

<br>

### Quais transformações de variáveis podem ser aplicadas?

-   Distribuições com assimetria à direita:[@osborne2010]

    -   Raiz quadrada

    -   Logaritmo natural

    -   Logaritmo base 10

    -   Transformação inversa

```{r assimetria-direita, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Transformações de variáveis com assimetria à direita (Original, Raiz quadrada, Log natural, Log10, Inversa).", out.width = "100%"}
# Reprodutibilidade
base::set.seed(123)
n <- 2000L
x <- stats::rlnorm(n, 0, 1)

# Criar data.frame
df <- base::data.frame(
  valor = base::c(x, sqrt(x), log(x), log10(x), 1/x),
  transform = base::factor(
    rep(c("Original",
          "Raiz quadrada (√x)",
          "Log natural (ln x)",
          "Log10 (log10 x)",
          "Inversa (1/x)"), each = n),
    levels = c("Original",
               "Raiz quadrada (√x)",
               "Log natural (ln x)",
               "Log10 (log10 x)",
               "Inversa (1/x)")
  )
)

# Histogramas
g_base <- ggplot2::ggplot(df, ggplot2::aes(x = valor)) +
  ggplot2::geom_histogram(
    bins = 30, fill = "lightblue", color = "black", linewidth = 0.2
  ) +
  ggplot2::labs(x = "Valor", y = "Frequência") +
  ggplot2::theme_minimal(base_size = 12) +
  ggplot2::theme(
    strip.text = ggplot2::element_text(face = "bold"),
    plot.title = ggplot2::element_text(face = "bold")
  )

# Gráficos das transformações
g1 <- g_base +
  ggplot2::facet_wrap(~ transform, scales = "free") +
  ggplot2::labs(title = "Transformações (Raiz, Log, Log10, Inversa)") +
  ggplot2::facet_wrap(~ transform, scales = "free", nrow = 1) +
  ggplot2::theme(axis.title.y = ggplot2::element_blank())

print(g1)
```

<br>

-   Distribuições com assimetria à esquerda:[@osborne2010]

    -   Reflexão e raiz quadrada

    -   Reflexão e logaritmo natural

    -   Reflexão e logaritmo base 10

    -   Reflexão e transformação inversa

<br>

```{r assimetria-esquerda, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Transformações de variáveis com assimetria à esquerda (Original, Reflexão + Raiz quadrada, Reflexão + Log natural, Reflexão + Log10, Reflexão + Inversa).", out.width = "100%"}
# Reprodutibilidade
base::set.seed(123)
n <- 2000L

# Aqui eu gero uma distribuição assimétrica à ESQUERDA
# partindo de uma lognormal refletida apenas para fins de exemplo.
x_right <- stats::rlnorm(n, meanlog = 0, sdlog = 1)    # assimétrica à direita
C <- max(x_right) + 1                                   # constante de reflexão > max(x)
x_left <- C - x_right                                   # agora é assimétrica à esquerda (positiva)

# Transformações por REFLEXÃO (Osborne, 2010)
x_reflect_sqrt  <- sqrt(x_left)     # Reflexão + raiz quadrada
x_reflect_logn  <- log(x_left)      # Reflexão + log natural
x_reflect_log10 <- log10(x_left)    # Reflexão + log base 10
x_reflect_inv   <- 1 / x_left       # Reflexão + inversa

# Empacotar em data.frame
df <- base::data.frame(
  valor = base::c(x_left, x_reflect_sqrt, x_reflect_logn, x_reflect_log10, x_reflect_inv),
  transform = base::factor(
    rep(c("Original (assimetria à esquerda)",
          "Reflexão + Raiz quadrada (√x*)",
          "Reflexão + Log natural (ln x*)",
          "Reflexão + Log10 (log10 x*)",
          "Reflexão + Inversa (1/x*)"), each = n),
    levels = c("Original (assimetria à esquerda)",
               "Reflexão + Raiz quadrada (√x*)",
               "Reflexão + Log natural (ln x*)",
               "Reflexão + Log10 (log10 x*)",
               "Reflexão + Inversa (1/x*)")
  )
)

# Gráfico base
g_base <- ggplot2::ggplot(df, ggplot2::aes(x = valor)) +
  ggplot2::geom_histogram(
    bins = 30, fill = "lightblue", color = "black", linewidth = 0.2
  ) +
  ggplot2::labs(x = "Valor", y = "Frequência") +
  ggplot2::theme_minimal(base_size = 12) +
  ggplot2::theme(
    strip.text = ggplot2::element_text(face = "bold"),
    plot.title  = ggplot2::element_text(face = "bold")
  )

# Painel com as transformações por reflexão
g_reflect <- g_base +
  ggplot2::facet_wrap(~ transform, scales = "free", nrow = 1) +
  ggplot2::labs(title = "Transformações para assimetria à esquerda (via reflexão)") +
  ggplot2::theme(axis.title.y = ggplot2::element_blank())

print(g_reflect)
```

<br>

-   Transformação arco-seno.[@osborne2010]

-   Transformação de Box-Cox.[@box1964]

-   Transformação de escore padrão (Z-score).

-   Escala Mínimo-Máximo (0,1).

-   Diferenciação.

-   Categorização.

-   Dicotomização.

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *MASS*[@MASS] fornece a função [*boxcox*](https://www.rdocumentation.org/packages/MASS/versions/7.3-58.3/topics/boxcox) para executar a transformação de Box-Cox.[@box1964]
:::

<br>

## Centralização de variáveis (*centering*)

<br>

### O que é centralização?

- É uma transformação linear em que se subtrai a média da variável de cada observação. O objetivo é recentrar a variável em torno de zero, sem alterar a sua variabilidade.[@REF]

<br>

### Por que centralizar?

- Facilita a interpretação dos coeficientes de regressão, especialmente em modelos com termos de interação.[@REF]

- Reduz a multicolinearidade entre variáveis e seus termos de interação ou polinomiais.[@REF]

- Mantém a escala original (apenas desloca a média).[@REF]

<br>

## Padronização de variáveis

<br>

### O que é padronização?

- Padronização é a transformação de uma variável contínua para uma escala comum, permitindo comparações entre variáveis medidas em diferentes unidades ou magnitudes.[@REF]

<br>

### Por que padronizar?

- Facilita a interpretação em análises multivariadas.[@REF]

- Evita que variáveis em escalas maiores dominem os resultados de algoritmos que dependem de distância.[@REF]

- Melhora a comparabilidade entre estudos e bases de dados diferentes..[@REF]

<br>

### Quais são os métodos de padronização mais comuns?

- Escore-Z (Z-score) \@ref(eq:zscore): subtrair a média e dividir pelo desvio-padrão.[@REF]

\begin{equation}
(\#eq:zscore)
Z = \frac{X - \mu}{\sigma}
\end{equation}

<br>

- Escala Min-Max \@ref(eq:minmax): transformar para o intervalo [0,1].[@REF]

\begin{equation}
(\#eq:minmax)
X_{norm} = \frac{X - X_{min}}{X_{max} - X_{min}}
\end{equation}

<br>

```{r padronizacao, echo=FALSE, warning=FALSE, message=FALSE, appendix=TRUE, fig.align='center', layout='Blank', ph=officer::ph_location_fullsize(), results='asis', fig.fullwidth=TRUE, fig.cap='Comparação entre variáveis originais e padronizadas (Z-score e Min-Max).', out.width='100%'}
# Reprodutibilidade
set.seed(123)

# 1. Gerar dados simulados
dados <- rnorm(100, mean = 50, sd = 10)

# 2. Padronizações
z_score <- scale(dados)
min_max <- (dados - min(dados)) / (max(dados) - min(dados))

# 3. Data frame tidy
resultado <- data.frame(
  Original = dados,
  Z_Score = as.numeric(z_score),
  Min_Max = min_max
)

# Função para gerar par de gráficos (histograma + boxplot com pontos)
make_plots <- function(v, nome) {
  df <- data.frame(valor = v)
  
  # Histograma
  p_hist <- ggplot2::ggplot(df, ggplot2::aes(x = valor)) +
    ggplot2::geom_histogram(bins = 15, fill = "skyblue", color = "black", alpha = 0.7) +
    ggplot2::labs(title = paste("Histograma -", nome), x = "Valor", y = "Frequência") +
    ggplot2::theme_minimal()
  
  # Boxplot + pontos
  p_box <- ggplot2::ggplot(df, ggplot2::aes(x = nome, y = valor)) +
    ggplot2::geom_boxplot(fill = "orange", color = "black", alpha = 0.6, width = 0.3) +
    ggplot2::geom_jitter(width = 0.1, alpha = 0.6, color = "blue") +
    ggplot2::labs(title = paste("Boxplot -", nome), x = "", y = "Valor") +
    ggplot2::theme_minimal()
  
  list(p_hist, p_box)
}

# 4. Criar gráficos para cada método
plots_original <- make_plots(resultado$Original, "Original")
plots_zscore   <- make_plots(resultado$Z_Score, "Z-Score")
plots_minmax   <- make_plots(resultado$Min_Max, "Min-Max")

# ---------------------------
# 5. Organizar em grid (3 linhas, 2 colunas)
# ---------------------------
gridExtra::grid.arrange(
  plots_original[[1]], plots_original[[2]],
  plots_zscore[[1]],   plots_zscore[[2]],
  plots_minmax[[1]],   plots_minmax[[2]],
  ncol = 2, nrow = 3
)
```

<br>

### Quais são as boas práticas de nomenclatura ao padronizar variáveis?

- Usar sufixos como `_z` ou `_std` para indicar padronização (`altura_z`, `peso_std`).[@REF]

- Documentar no dicionário de dados como cada variável foi transformada.[@REF]

- Evitar substituir a variável original: manter sempre a versão bruta e a padronizada.[@REF]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *base*[@base] fornece a função [*scale*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/scale) para calcular automaticamente a padronização (média = 0, desvio padrão = 1).  
:::

<br>

## Categorização de variáveis contínuas

<br>

### O que é categorização de uma variável?

-   .[@REF]

<br>

### Por que não é recomendado categorizar variáveis contínuas?

-   Nenhum dos argumentos usados para defender a categorização de variáveis se sustenta sob uma análise técnica rigorosa.[@MacCallum2002]

-   Categorizar variáveis não é necessário para conduzir análises estatísticas. Ao invés de categorizar, priorize as variáveis contínuas.[@Altman2006; @Royston2006; @Collins2016]

-   Em geral, não existe uma justificativa racional (plausibilidade biológica) para assumir que as categorias artificiais subjacentes existam.[@Altman2006; @Royston2006; @Collins2016]

-   Caso exista um ponto de corte ou limiar verdadeiro que discrimine três ou mais grupos independentes, identificar tal ponto de corte ainda é um desafio.[@Prince2017]

-   Categorização de variáveis contínuas aumenta a quantidade de testes de hipótese para comparações pareadas entre os quantis, inflando, portanto, o erro tipo I.[@Bennette2012]

-   Categorização de variáveis contínuas requer uma função teórica que pressupõe a homogeneidade da variável dentro dos grupos, levando tanto a uma perda de poder como a uma estimativa imprecisa.[@Bennette2012]

-   Categorização de variáveis contínuas pode dificultar a comparação de resultados entre estudos devido aos pontos de corte baseados em dados de um banco usados para definir as categorias.[@Bennette2012]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *questionr*[@questionr] fornece a função [*irec*](https://www.rdocumentation.org/packages/questionr/versions/0.7.8/topics/irec) para executar uma interface interativa para codificação de variáveis categóricas.
:::

<br>

### Quais são as alternativas à categorização de variáveis contínuas?

-   Análise com os dados das variáveis na escala de medida original.[@MacCallum2002]

-   Análise com modelos de regressão com pesos locais (*lowess*) tais como *splines* e polinômios fracionais.[@MacCallum2002]

<br>

## Dicotomização de variáveis contínuas

<br>

### O que são variáveis dicotômicas?

-   Variáveis dicotômicas (ou binárias) podem representar categorias naturais tipo "presente/ausente", "sim/não".[@REF]

-   Variáveis dicotômicas podem representar categorias fictícias, criadas a partir de variáveis multinominais, em que cada nível é convertido em uma variável dicotômica indicatoda (*dummy*).[@REF]

-   Dicotomização é considerado um artefato da análise de dados, uma vez que é realizada após a coleta de dados.[@aguinis2008]

-   Geralmente são representadas por "1" (presente, sucesso) e "0" (ausente, falha).[@REF]

<br>

### Quais argumentos são usados para defender a categorização ou dicotomização de variáveis contínuas?

-   O argumento principal para dicotomização de variáveis é que tal procedimento facilita e simplifica a apresentação dos resultados, principalmente para o público em geral.[@Fedorov2009]

-   Os pesquisadores não conhecem as consequências estatísticas da dicotomização.[@MacCallum2002]

-   Os pesquisadores não conhecem os métodos adequados de análise não-paramétrica, não-linear e robusta.[@MacCallum2002]

-   As categorias representam características existentes dos participantes da pesquisa, de modo que as análises devam ser feitas por grupos e não por indivíduos.[@MacCallum2002]

-   A confiabilidade da(s) variável(eis) medida(s) é baixa e, portanto, categorizar os participantes resultaria em uma medida mais confiável.[@MacCallum2002]

<br>

### Por que não é recomendado dicotomizar variáveis contínuas?

-   Nenhum dos argumentos usados para defender a dicotomização de variáveis se sustenta sob uma análise técnica rigorosa.[@MacCallum2002]

-   Dicotomizar variáveis não é necessário para conduzir análises estatísticas. Ao invés de dicotomizar, priorize as variáveis contínuas.[@Altman2006; @Royston2006; @Collins2016]

-   Em geral, não existe uma justificativa racional (plausibilidade biológica) para assumir que as categorias artificiais subjacentes existam.[@Altman2006; @Royston2006; @Collins2016]

-   Dicotomização causa perda de informação e consequentemente perda de poder estatístico para detectar efeitos.[@MacCallum2002; @Altman2006]

-   Dicotomização também classifica indivíduos com valores próximos na variável contínua como indivíduos em pontos opostos e extremos, artificialmente sugerindo que são muito diferentes.[@Altman2006]

-   Dicotomização pode diminuir a variabilidade das variáveis.[@Altman2006]

-   Dicotomização pode ocultar não-linearidades presentes na variável contínua.[@MacCallum2002; @Altman2006]

-   A média ou a mediana, embora amplamente utilizadas, não são bons parâmetros para dicotomizar variáveis.[@Altman2006; @Fedorov2009]

-   Caso exista um ponto de corte ou limiar verdadeiro que discrimine dois grupos independentes, identificar tal ponto de corte ainda é um desafio.[@Prince2017]

<br>

### Quais cenários legitimam a dicotomização das variáveis contínuas?

-   Quando existem dados e/ou análises que suportem a existência - não apenas a suposição ou teorização - de categorias com um ponto de corte claro e com significado entre elas.[@MacCallum2002]

-   Quando a distribuição da variável contínua é muito assimétrica, de modo que uma grande quantidade de observações está em um dos extremos da escala.[@MacCallum2002]

<br>

### Quais métodos são usados para dicotomizar variáveis contínuas?

-   Em termos de tabelas de contingência 2x2, os seguintes métodos permitem[@Prince2017] a identificação do limiar verdadeiro:

    -   Youden.[@YOUDEN1950]

    -   Gini Index.[@strobl2007]

    -   Estatística qui-quadrado ($\chi^2$).[@pearson1900]

    -   Risco relativo ($RR$).[@Greiner2000]

    -   Kappa ($\kappa$).[@fleiss1971].

<br>

## Fatores

<br>

### O que são fatores?

-   Fator é um sinônimo de variável categórica.[@REF]

-   Na modelagem, fator é sinônimo de variável preditora, em particular quando se refere à modelagem de efeitos fixos e aleatórios -- os fatores (variáveis) são fatores fixos ou fatores aleatórios.[@REF]

-   Fatores são variáveis controladas pelos pesquisadores em um experimento para determinar seu efeito na(s) variável(ies) de resposta. Um fator pode assumir apenas um pequeno número de valores, conhecidos como níveis. Os fatores podem ser uma variável categórica ou baseados em uma variável contínua, mas usam apenas um número limitado de valores escolhidos pelos experimentadores.[@REF]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *base*[@base] fornece a função [*as.factor*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/factor) para converter uma variável em fator.
:::

<br>

### O que são níveis de um fator?

-   Níveis de um fator são as possíveis categorias que descrevem um fator.[@REF]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *base*[@base] fornece as funções [*levels*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/levels) e [*nlevels*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/nlevels) para listar os níveis e a quantidade deles em um fator.
:::

<br>

```{r, echo=FALSE, warning=FALSE, results='asis', eval=knitr::is_html_output()}
cat(readLines("citation.html"), sep = "\n")
```

<br>
