```{=openxml}
<w:p>
  <w:r>
    <w:br w:type="page"/>
  </w:r>
</w:p>
```

# **Suposições inferenciais** {#suposicoes-inferenciais}

<br>

## Suposições gerais em análises inferenciais

<br>

### Quais são as suposições ao nível dos dados (condicionais ao modelo)?

- Independência (ou dependência corretamente modelada) das observações: .[REF]

- Forma da distribuição dos erros ou resíduos (normalidade, assimetria, caudas): .[REF]

- Homocedasticidade (igualdade de variâncias condicionais): .[REF]

<br>

### Quais são as suposições ao nível do modelo?

- Linearidade da relação entre variáveis: .[REF]

- Multicolinearidade ausente ou controlada: .[REF]

- Especificação funcional correta do modelo: .[REF]

<br>

### Quais são as suposições ao nível do estudo?

- Ausência de confundimento relevante não controlado: .[REF]

- Estabilidade do processo gerador de dados (invariância temporal, populacional ou contextual): .[REF]

<br>

## Suposições implícitas e explícitas nos testes

<br>

### Quais suposições implícitas são feitas nos testes estatísticos?

- Amostragem aleatória ou ignorabilidade condicional: .[REF]

- Medição sem erro relevante: .[REF]

- Correspondência entre modelo estatístico e processo gerador de dados: .[REF]

- Ausência de múltiplas comparações não ajustadas: .[REF]

<br>

### Quais suposições explícitas são feitas nos testes estatísticos?

- Normalidade dos erros ou da estatística de teste: .[REF]

- Homocedasticidade: .[REF]

- Independência das observações: .[REF]

<br>

## Suposições causais que conectam dados observados a efeitos causais

<br>

### Quais são as suposições causais que conectam dados observados a efeitos causais?

- Ausência de correlação espúria: associações observadas refletem relações sistemáticas e não flutuações aleatórias; quanto maior a amostra, mais plausível essa condição.[@REF]

- Consistência: os valores observados do tratamento correspondem a intervenções bem definidas e coincidem com os valores dos contrafactuais relevantes.[@REF]

- Intercambialidade: condicionalmente às covariáveis medidas, a atribuição do tratamento é independente dos desfechos potenciais.[@REF]

- Positividade: para todos os valores das covariáveis consideradas, a probabilidade de receber cada nível do tratamento é maior que zero.[@REF]

- Fidelidade: efeitos causais não se cancelam sistematicamente no agregado populacional, de modo que efeitos médios nulos correspondem à ausência de efeito causal relevante.[@REF]

<br>

### Qual a relação dessas suposições com as demais suposições inferenciais?

- Essas suposições operam antes do modelo estatístico.[@REF]

- Não são verificáveis por diagnóstico residual ou testes de ajuste.[@REF]

- Mesmo com todas as suposições estatísticas satisfeitas, a inferência causal pode falhar se qualquer uma dessas suposições não for atendida.[@REF]

<br>

## Diagnóstico e verificação

<br>

### O que fazer quando suposições gerais falham?

- Transformações: .[REF]

- Métodos robustos (estimadores e testes): .[REF]

- Reamostragem: .[REF]

- Modelos alternativos: .[REF]

<br>

### O que fazer quando as suposições causais falham?

- Clarificar o alvo causal: redefinir a população, o tratamento ou o efeito de interesse.[REF]

- Análise de sensibilidade: avaliar quanto confundimento não medido seria necessário para invalidar as conclusões.[REF]

- Restringir o suporte: limitar a análise a regiões com positividade plausível (suporte comum).[REF]

- Estratificação ou ajuste enriquecido: incluir covariáveis adicionais relevantes, quando disponíveis.[REF]

- Modelagem causal explícita: usar DAGs para tornar suposições transparentes e discutíveis.[REF]

- Estimativas parciais ou locais: reportar efeitos condicionais ou locais quando o efeito médio não é identificável.[REF]

- Conclusões mais fracas: interpretar resultados como associações ajustadas, não como efeitos causais.[REF]

- Relato explícito das falhas: documentar quais suposições não são plausíveis e por quê.[REF]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *performance*[@performance] fornece a função [*check_model*](https://www.rdocumentation.org/packages/performance/versions/0.10.4/topics/check_model) para analisar a colinearidade entre variáveis, a normalidade da distribuição das variáveis e a heteroscedasticidade.
:::

<br>

### Como avaliar as suposições de uma regressão?

-   Usando diagnóstico de regressão (ex.: análise de resíduos, gráficos de valores observados vs. preditos) e comparação com análises estratificadas.[@Greenland1989]

<br>

```{r suposicoes, include = TRUE, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Diagnóstico de regressão para avaliar suposições do modelo: linearidade, normalidade dos resíduos, homocedasticidade e alavancagem."}
library(dplyr)

# Definir semente
set.seed(123)

# Simular dados
n <- 100
x1 <- stats::rnorm(n, mean = 50, sd = 10)
x2 <- stats::rnorm(n, mean = 30, sd = 5)
erro <- stats::rnorm(n, mean = 0, sd = 5)
y <- 10 + 0.5 * x1 - 0.3 * x2 + erro

# Data frame
dados <- data.frame(y = y, x1 = x1, x2 = x2)

# Modelo
modelo <- stats::lm(y ~ x1 + x2, data = dados)

# Dados auxiliares para gráficos
dados_diag <- dados %>%
  dplyr::mutate(
    Ajustado = stats::fitted(modelo),
    Resíduo = stats::resid(modelo),
    Resíduo_pad = stats::rstandard(modelo),
    Raiz_Resíduo_pad = sqrt(abs(Resíduo_pad)),
    Cook = stats::cooks.distance(modelo),
    Alavancagem = stats::hatvalues(modelo)
  )

# Gráfico 1: Resíduos vs Ajustados
g1 <- ggplot2::ggplot(dados_diag, ggplot2::aes(x = Ajustado, y = Resíduo)) +
  ggplot2::geom_point(color = "blue") +
  ggplot2::geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
  ggplot2::labs(title = "Resíduos vs Ajustados", subtitle = "--- Resíduo = 0",
                x = "Valores Ajustados", y = "Resíduos") +
  ggplot2::theme_minimal()

# Gráfico 2: QQ Plot
g2 <- ggplot2::ggplot(dados_diag, ggplot2::aes(sample = Resíduo)) +
  ggplot2::stat_qq(color = "darkgreen") +
  ggplot2::stat_qq_line(color = "black", linetype = "dashed") +
  ggplot2::labs(title = "Normal Q-Q", subtitle = "--- Distribuição Normal Teórica",
                x = "Quantis Teóricos", y = "Resíduos") +
  ggplot2::theme_minimal()

# Gráfico 3: Scale-Location
g3 <- ggplot2::ggplot(dados_diag, ggplot2::aes(x = Ajustado, y = Raiz_Resíduo_pad)) +
  ggplot2::geom_point(color = "orange") +
  ggplot2::geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
  ggplot2::labs(title = "Scale-Location", subtitle = "--- Referência visual",
                x = "Valores Ajustados", y = "√|Resíduos Padronizados|") +
  ggplot2::theme_minimal()

# Gráfico 4: Distância de Cook
g4 <- ggplot2::ggplot(dados_diag, ggplot2::aes(x = seq_along(Cook), y = Cook)) +
  ggplot2::geom_segment(ggplot2::aes(xend = seq_along(Cook), yend = 0), color = "purple") +
  ggplot2::geom_hline(yintercept = 4/n, linetype = "dashed", color = "black") +
  ggplot2::labs(title = "Distância de Cook", subtitle = "--- Limite sugerido (4/n)",
                x = "Observação", y = "Distância") +
  ggplot2::theme_minimal()

# Gráfico 5: Observado vs Ajustado
lim <- range(c(dados_diag$y, dados_diag$Ajustado))
g5 <- ggplot2::ggplot(dados_diag, ggplot2::aes(x = y, y = Ajustado)) +
  ggplot2::geom_point(color = "darkblue") +
  ggplot2::geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +
  ggplot2::coord_cartesian(xlim = lim, ylim = lim) +
  ggplot2::labs(title = "Observado vs Ajustado", subtitle = "--- y = x",
                x = "Valores Observados", y = "Valores Ajustados") +
  ggplot2::theme_minimal()

# Gráfico 6: Alavancagem
g6 <- ggplot2::ggplot(dados_diag, ggplot2::aes(x = seq_along(Alavancagem), y = Alavancagem)) +
  ggplot2::geom_point(color = "darkred") +
  ggplot2::geom_hline(yintercept = 2 * mean(dados_diag$Alavancagem), linetype = "dashed", color = "black") +
  ggplot2::labs(title = "Alavancagem", subtitle = "--- 2 × média",
                x = "Observação", y = "Valores de Alavancagem") +
  ggplot2::theme_minimal()

# Organizar os 6 gráficos em 2x3
gridExtra::grid.arrange(g1, g2, g3, g4, g5, g6, nrow = 2)
```

<br>

```{r, echo=FALSE, warning=FALSE, results='asis', eval=knitr::is_html_output()}
cat(readLines("citation.html"), sep = "\n")
```

<br>
