# **Desempenho diagnóstico** {#analise-desempenho-diagnostico}

<br>

## Tabelas 2x2 {#tabelas-2x2}

<br>

### Como analisar o desempenho diagnóstico em tabelas 2x2?

- Verdadeiro-positivo ($VP$): caso com a condição presente e corretamente identificado como tal.[@greenhalgh1997b]

- Falso-negativo ($FN$): caso com a condição presente e erroneamente identificado como ausente.[@greenhalgh1997b]

- Verdadeiro-negativo ($VN$): controle sem a condição presente e corretamente identificados como tal.[@greenhalgh1997b]

- Falso-positivo ($FP$): controle sem a condição presente e erroneamente identificado como presente.[@greenhalgh1997b]

<br>

```{r crosstable, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', results = "asis"}

cross.table <- matrix(c('$VP$', '$FN$', '$FP$', '$VN$'), nrow = 2, ncol = 2, byrow = FALSE)
rownames(cross.table) <- c("Teste positivo", "Teste negativo")
colnames(cross.table) <- c("Condição presente", "Condição ausente")

# exibe a tabela de dados
kableExtra::kable(
  cross.table,
  align = "c",
  format = ifelse(knitr::is_html_output(), "html", "latex"),
  booktabs = TRUE,
  linesep = "",
  escape = FALSE,
  caption = "Tabela de confusão 2x2 para análise de desempenho diagnóstico de testes e variáveis dicotômicas."
) %>%
  kableExtra::kable_styling(
    latex_options = c("basic"),
    bootstrap_options = c("basic", "hover", "condensed", "responsive"),
    full_width = ifelse(knitr::is_html_output(), T, T),
    position = "center"
  ) %>%
  kableExtra::row_spec(0,
                       bold = TRUE,
                       extra_css = "border-top: 1px solid; border-bottom: 1px solid") %>%
  kableExtra::row_spec(dim(cross.table)[1],
                       extra_css = "border-bottom: 1px solid")
```

<br>

### Quais probabilidades caracterizam o desempenho diagnóstico de um teste em tabelas 2x2?

-   Sensibilidade ($SEN$): Proporção de verdadeiro-positivos dentre aqueles com a condição.[@greenhalgh1997b]

-   Especificidade ($ESP$): Proporção de verdadeiro-negativos dentre aqueles sem a condição.[@greenhalgh1997b]

-   Acurácia ($ACU$): Proporção de casos e controle corretamente identificados.[@greenhalgh1997b]

-   Valor preditivo positivo ($VPP$): Proporção de casos corretamente identificados como verdadeiro-positivos.[@greenhalgh1997b]

-   Valor preditivo negativo ($VPN$): Proporção de controles corretamente identificados como verdadeiro-negativos.[@greenhalgh1997b]

- Razão de verosimilhança ($RV$).[@greenhalgh1997b]

<br>

```{r crosstable-prob, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', results = "asis"}

cross.table <- matrix(c('$VP$', '$FN$', '$SEN = \\frac{VP}{VP+FN}$', '$FP$', '$VN$', '$ESP = \\frac{VN}{VN+FP}$', '$VPP = \\frac{VP}{VP+FP}$', '$VPN = \\frac{VN}{VN+FN}$', '$ACU = \\frac{VP+VN}{VP+VN+FP+FN}$'), nrow = 3, ncol = 3, byrow = FALSE)
rownames(cross.table) <- c("Teste positivo", "Teste negativo", "Probabilidades")
colnames(cross.table) <- c("Condição presente", "Condição ausente", "Probabilidades")

# exibe a tabela de dados
kableExtra::kable(
  cross.table,
  align = "c",
  format = ifelse(knitr::is_html_output(), "html", "latex"),
  booktabs = TRUE,
  linesep = "",
  escape = FALSE,
  caption = "Probabilidades calculados a partir da tabela de confusão 2x2 para análise de desempenho diagnóstico de testes e variáveis dicotômicas."
) %>%
  kableExtra::kable_styling(
    latex_options = c("basic"),
    bootstrap_options = c("basic", "hover", "condensed", "responsive"),
    full_width = ifelse(knitr::is_html_output(), T, T),
    position = "center"
  ) %>%
  kableExtra::row_spec(0,
                       bold = TRUE,
                       extra_css = "border-top: 1px solid; border-bottom: 1px solid") %>%
  kableExtra::row_spec(dim(cross.table)[1] - 1,
                       extra_css = "border-bottom: 1px solid")  %>%
  kableExtra::row_spec(dim(cross.table)[1],
                       extra_css = "border-bottom: 1px solid")
```

<br>

## Curvas ROC {#curvas-roc}

<br>

### O que é a área sob a curva (AUROC)?

-   A área sob a curva ROC (AUC ou AUROC) quantifica o poder de discriminação ou desempenho diagnóstico na classificação de uma variável dicotômica.[@de2022]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *proc*[@pROC] fornece a função [*plot.roc*](https://www.rdocumentation.org/packages/pROC/versions/1.18.4/topics/plot.roc) para criar uma curva ROC.
:::

<br>

### Como interpretar a área sob a curva (ROC)?

-   A área sob a curva AUC varia no intervalo $[0.5; 1]$, com valores mais elevados indicando melhor discriminação ou desempenho do modelo de classificação.[@de2022]

-   As interpretações qualitativas (isto é, pobre/fraca/baixa, moderada/razoável/aceitável, boa ou muito boa/alta/excelebt) dos valores de área sob a curva são arbitrários e não devem ser considerados isoladamente.[@de2022]

-   Modelos de classificação com valores altos de área sob a curva podem ser enganosos se os valores preditos por esses modelos não estiverem adequadamente calibrados.[@de2022]

<br>

### Como analisar o desempenho diagnóstico em desfechos com distribuição trimodal na população?

-   Limiares duplos podem ser utilizados para análise de desempenho diagnóstico de testes com distribuição trimodal.[@ferreira2021]

<br>

## Interpretação da validade de um teste {#interpretacao-desempenho}

<br>

### Que itens devem ser verificados na interpretação de um etudo de validade?

- O novo teste foi comparado junto ao método padrão-ouro.[@greenhalgh1997b]

- As probabildidades pontuais estimadas que caracterizam o desempenho diagnóstico do novo teste são altas e adequadas para sua aplicação clínica.[@greenhalgh1997b]

- Os intervalos de confiança estimados para as probabilidades do novo teste são estreitos e adequadas para sua aplicação clínica.[@greenhalgh1997b]

- O novo teste possui adequada confiabilidade intra/inter examinadores.[@greenhalgh1997b]

- O estudo de validação incluiu um espectro adequado da amostra.[@greenhalgh1997b]

- Todos os participantes realizaram ambos o novo teste e o padrão-ouro no estudo de validação.[@greenhalgh1997b]

- Os examinadores do novo teste estavam cegados para o resultado do teste padrão-ouro.[@greenhalgh1997b]

<br>
