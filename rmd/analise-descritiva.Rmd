# **Análise descritiva** {#analise-descritiva}

<br>

## Análise descritiva

<br>

### O que é análise descritiva?

-   Análise descritiva é usada para compreendermos algum aspecto de um conjunto de dados, respondendo a perguntas do tipo "quando?", "onde?", "quem?", "o quê?", "como?" e "e daí?".[@gerring2012; @vetter2017]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *base*[@base] fornece a função [*summary*](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/summary) para calcular diversos parâmetros descritivos.
:::

<br>

### Como apresentar os resultados descritivos?

-   Variáveis categóricas: Reporte valores de frequência absoluta e relativa (n, percentual).[@Cummings2003]

-   Organização das tabelas: as variáveis são exibidas em linhas e os grupos são exibidos em colunas.[@Cummings2003]

-   Calcule percentagens para as colunas (isto é, entre grupos) e não entre linhas.[@Cummings2003]

-   Em caso de dados perdidos, não inclua uma linha com total de dados perdidos, pois distorce as proporções entre colunas e as análises de tabela de contingência. Indique no texto ou em uma coluna separada o total de dados perdidos por variável.[@Cummings2003]

<br>

## Apresentação de resultados numéricos

<br>

### O que são casas decimais?

-   O número de casas decimais refere-se à quantidade de dígitos que aparecem após a vírgula decimal.[@Cole2015a; @cole2015b]

-   Para tamanhos de efeito: use 2–3 dígitos significativos.[@Weissgerber2019]

-   Para medidas de variabilidade (SD/SE/IC): use 1–2 dígitos significativos.[@Weissgerber2019]

<br>

### O que são dígitos significativos?

-   O termo "dígitos significativos" é preferido a "algarismos significativos" ou "dígitos efetivos" e não se relaciona com significância estatística.[@Cole2015a; @cole2015b]

-   O número de dígitos significativos é a soma total de dígitos, desconsiderando a vírgula decimal e os zeros à esquerda; os zeros à direita são considerados informativos, salvo exceções.[@Cole2015a; @cole2015b]

<br>

### Como arredondar dados numéricos?

-   Apresentar dados com quantidade excessiva de casas decimais pode dificultar a interpretação e induzir erroneamente uma precisão espúria.[@Cole2015a; @cole2015b]

-   A precisão é determinada pelo grau de arredondamento aplicado, medido em casas decimais ou dígitos significativos.[@Cole2015a; @cole2015b]

<br>

```{r casas-decimais, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE}
library(dplyr)

# Criar um dataframe com exemplos de casas decimais e dígitos significativos
dados <- data.frame(
  Valor = c(0.00789, 0.0456, 45.600, 123.456, 7890)
)

# Calcular casas decimais
dados$'Casas Decimais' <- sapply(dados$Valor, function(x) {
  if (x == 0) return(0)
  else return(nchar(sub(".*\\.", "", as.character(x))))
})

# Calcular dígitos significativos
dados$'Dígitos Significativos' <- sapply(dados$Valor, function(x) {
  gsub("^0+|\\..*", "", as.character(x)) %>%
  nchar()
})

# Remover zeros à direita e formatar os valores
dados$Valor <- sapply(1:nrow(dados), function(i) {
  format(dados$Valor[i], nsmall = dados$`Casas Decimais`[i], 
         scientific = FALSE, 
         trim = TRUE, 
         decimal.mark = ",")
})

# exibe a tabela de dados
kableExtra::kable(
  dados,
  align = c("r", "c", "c"),
  format = ifelse(knitr::is_html_output(), "html", "latex"),
  booktabs = TRUE,
  linesep = "",
  escape = FALSE,
  caption = "Quantidade de casas decimais e dígitos significativos."
) %>%
  kableExtra::kable_styling(
    latex_options = c("basic"),
    bootstrap_options = c("basic", "hover", "condensed", "responsive"),
    full_width = ifelse(knitr::is_html_output(), T, T),
    position = "center"
  ) %>%
  kableExtra::row_spec(0,
                       bold = TRUE,
                       extra_css = "border-top: 1px solid; border-bottom: 1px solid") %>%
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::row_spec(dim(dados)[1],
                       extra_css = "border-bottom: 1px solid")
```

<br>

-   O arredondamento também introduz erros, uma vez que aumenta a imprecisão (isto é, incerteza) em torno do valor original.[@Cole2015a; @cole2015b]

<br>

```{r arredondamento, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE}
library(dplyr)

# Criar um dataframe com exemplos de casas decimais e dígitos significativos
dados <- data.frame(
  Valor = c(0.00789, 0.0456, 45.600, 123.456, 7890)
)

# Calcular casas decimais
dados$'Casas Decimais' <- sapply(dados$Valor, function(x) {
  if (x == 0) return(0)
  else return(nchar(sub(".*\\.", "", as.character(x))))
})

# Calcular dígitos significativos
dados$'Dígitos Significativos' <- sapply(dados$Valor, function(x) {
  gsub("^0+|\\..*", "", as.character(x)) %>%
    nchar()
})

# Remover zeros à direita e formatar os valores
dados$Valor <- sapply(1:nrow(dados), function(i) {
  format(dados$Valor[i], nsmall = dados$`Casas Decimais`[i], 
         scientific = FALSE, 
         trim = TRUE, 
         decimal.mark = ",")
})

# Função para calcular arredondamento e faixa de erro
calcular_erro <- function(x_str, casas){
  x <- as.numeric(gsub(",", ".", x_str))
  r <- round(x, casas)
  half <- 0.5 * 10^(-casas)
  paste0(
    format(r, nsmall=casas, decimal.mark=","),
    " [",
    format(r - half, nsmall=casas+1, decimal.mark=","),
    ", ",
    format(r + half, nsmall=casas+1, decimal.mark=","),
    "]"
  )
}

dados$'2 Casas decimais [Margem de erro]' <- sapply(dados$Valor, function(x) {
  calcular_erro(x, 2)
})

dados$'1 Casa decimal [Margem de erro]' <- sapply(dados$Valor, function(x) {
  calcular_erro(x, 1)
})

dados$'Sem casa decimal [Margem de erro]' <- sapply(dados$Valor, function(x) {
  calcular_erro(x, 0)
})

# exibe a tabela de dados
kableExtra::kable(
  dados,
  align = c("r", "c", "c", "r", "r", "r"),
  format = ifelse(knitr::is_html_output(), "html", "latex"),
  booktabs = TRUE,
  linesep = "",
  escape = FALSE,
  caption = "Valores originais, arredondamentos e erros de arredondamento por casas decimais."
) %>%
  kableExtra::kable_styling(
    latex_options = c("basic"),
    bootstrap_options = c("basic", "hover", "condensed", "responsive"),
    full_width = ifelse(knitr::is_html_output(), T, T),
    position = "center"
  ) %>%
  kableExtra::row_spec(0,
                       bold = TRUE,
                       extra_css = "border-top: 1px solid; border-bottom: 1px solid") %>%
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::row_spec(dim(dados)[1],
                       extra_css = "border-bottom: 1px solid")
```

<br>

-   A regra geral é utilizar 2 ou 3 dígitos significativos para tamanhos de efeito e 1 ou 2 dígitos significativos para medidas de variabilidade.[@cole2015b]

-   Regra dos 3 dígitos significativos para proporção de risco: em média, o erro de arredondamento é menor que os 0,5% exigidos, de modo que três dígitos significativos são mais precisos do que o necessário.[@Cole2015a]

-   Regra dos 4 dígitos significativos para proporção de risco: divida a proporção de risco por quatro e arredonde para dois dígitos significativos e, em seguida, relate a proporção para esse número de casas decimais.[@Cole2015a]

<br>

## Tabelas

<br>

### Por que usar tabelas?

-   Tabelas complementam o texto (e vice-versa), e podem apresentar os dados de modo mais acessível e informativo.[@Inskip2017]

<br>

### Que informações incluir nas tabelas?

-   Título ou legenda, uma síntese descritiva (geralmente por meio de parâmetros descritivos), intervalos de confiança e/ou P-valores conforme necessário para adequada interpretação.[@Inskip2017; @Kwak2021]

<br>

### Quais são os tipos de tabelas?

<br>

-   Tabela de frequência: apresenta a quantidade de ocorrências (frequência absoluta e relativa) de cada categoria de uma variável; usada com variáveis qualitativas ou quantitativas discretas.[@REF]

-   Tabela de frequência agrupada: organiza dados contínuos em intervalos de classe (ex: faixas etárias) e mostra as frequências correspondentes.[@REF]

-   Tabela de contingência (ou tabela cruzada): cruza duas variáveis categóricas, permitindo observar possíveis associações entre elas.[@REF]

-   Tabela de medidas descritivas: resume variáveis quantitativas com estatísticas como média, mediana, desvio-padrão, mínimo, máximo e quartis.[@REF]

-   Tabela de comparação entre grupos: apresenta médias, desvios-padrão e ocasionalmente resultados de testes de inferência estatística para comparar dois ou mais grupos.[@REF]

-   Tabela de resultados de testes estatísticos: exibe valores de estatísticas de teste , P valores e intervalos de confiança; usada para mostrar inferências.[@REF]

-   Tabela de regressão (ou de modelos estatísticos): mostra os coeficientes de regressão, erros padrão, intervalos de confiança e P valores para cada variável de um modelo.[@REF]

-   Tabela de séries temporais ou longitudinais: organiza dados medidos em diferentes momentos no tempo, permitindo visualizar tendências ou variações longitudinais.[@REF]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *gtsummary*[@gtsummary] fornece a função [*tbl_summary*](https://search.r-project.org/CRAN/refmans/gtsummary/html/tbl_summary.html) para construção da 'Tabela 1' com dados descritivos.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *table1*[@table1] fornece a função [*table1*](https://search.r-project.org/CRAN/refmans/table1/html/table1.html) para construção de tabelas.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *flextable*[@flextable] fornece as funções [*flextable*](https://search.r-project.org/CRAN/refmans/flextable/html/flextable.html), [*as_flextable*](https://search.r-project.org/CRAN/refmans/flextable/html/as_flextable.html) e [*save_as_docx*](https://search.r-project.org/CRAN/refmans/flextable/html/save_as_docx.html) para criar e salvar tabelas formatadas em DOCX.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *rempsyc*[@rempsyc] fornece a função [*nice_table*](https://search.r-project.org/CRAN/refmans/rempsyc/html/nice_table.html) para criar tabelas formatadas.
:::

<br>

### Quais são os erros mais comuns de preenchimento de tabelas?

-   Erros tipográficos.[@barnett2023]

-   Ausência de rótulos ou unidades nas variáveis.[@barnett2023]

-   Relatar estatísticas incorretamente, tais como rotular variáveis contínuas como porcentagens.[@barnett2023]

-   Estatísticas descritivas de tendência central (ex.: médias) relatadas sem a estatística de dispersão correspondente (ex.: desvio-padrão).[@barnett2023]

-   Desvio-padrão nulo ($\sigma=0$).[@barnett2023]

-   Valores porcentuais que não correspondem ao numerador dividido pelo denominador.[@barnett2023]

<br>

## Tabela 1

<br>

### O que é a 'Tabela 1'?

-   A 'Tabela 1' descreve as características demográficas, sociais e clínicas da amostra, completa ou agrupada por algum fator, geralmente por meio de parâmetros de tendência central e dispersão.[@Westreich2013; @chen2020]

<br>

### Qual a utilidade da 'Tabela 1'?

-   Descrever (conhecer) as características da amostra e dos grupos sendo comparados, quando aplicável.[@chen2020]

-   Verificar aderência ao protocolo do estudo, incluindo critérios de inclusão/exclusão, tamanho da amostra e perdas amostrais.[@chen2020]

-   Permitir a replicação do estudo.[@chen2020]

-   Meta-analisar os dados junto a estudos similares.[@chen2020]

-   Avaliar a generalização (validade externa) das conclusões do estudo.[@chen2020]

<br>

### O que é a falácia da 'Tabela 1'?

-   Falácia da Tabela 1 ocorre pela interpretação errônea dos P-valores na comparação entre grupos, na linha de base, de um ensaio clínico aleatorizado.[@pijls2022]

-   Não interprete P da linha de base em ensaios clínicos como “desequilíbrio” (falácia da Tabela 1). Mantenha P-valor apenas como descritivo (ou omita), enfatizando desenho e aleatorização.[@Weissgerber2019]

<br>

### Como construir a 'Tabela 1'?

-   A Tabela 1 geralmente é utilizada para descrever as características da amostra estudada, possibilitando a análise de ameaças à validade interna e/ou externa ao estudo.[@greenhalgh1997; @Hayes-Larson2019]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *table1*[@table1] fornece a função [*table1*](https://search.r-project.org/CRAN/refmans/table1/html/table1.html) para construção de tabelas.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *gtsummary*[@gtsummary] fornece a função [*tbl_summary*](https://search.r-project.org/CRAN/refmans/gtsummary/html/tbl_summary.html) para construção da 'Tabela 1' com dados descritivos.
:::

<br>

```{r tabela-1, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE}
# Reprodutibilidade
set.seed(123)

# Gerar dados de exemplo
dados <- tibble::tibble(
  Grupo = sample(c("Controle","Intervenção"), 200, TRUE),
  Sexo  = sample(c("F","M"), 200, TRUE),
  Idade = round(rnorm(200, 60, 12), 1),
  IMC   = round(rnorm(200, 27, 4), 1)
)

# Tabela
gtsummary::theme_gtsummary_language("pt")
tbl1 <- dados |>
  gtsummary::tbl_summary(
    by = Grupo,
    type = list(Idade ~ "continuous2", IMC ~ "continuous2"),
    statistic = gtsummary::all_continuous() ~
      c("{mean} ({sd})", "{median} [{p25}, {p75}]"),
    missing_text = "Dados ausentes"
  ) |>
  gtsummary::add_n() |>
  gtsummary::add_p() |>
  gtsummary::modify_caption("**Características da amostra por grupo.**")

tbl1
```

<br>

## Tabela 2

<br>

### Qual a utilidade da 'Tabela 2'?

-   A Tabela 2 mostra associações ajustadas multivariadas com o resultado para variáveis resumidas na Tabela 1.[@Westreich2013]

<br>

### O que é a falácia da 'Tabela 2'?

-   A Tabela 2 pode induzir ao erro de interpretação pelas estimativas de efeitos para covariáveis do modelo também serem utilizados para controlar a confusão da exposição.[@Westreich2013; @bandoli2018]

-   Ao apresentar estimativas de efeito ajustadas para covariáveis juntamente com a estimativa de efeito ajustada para a exposição primária, a Tabela 2 sugere implicitamente que todas estas estimativas podem ser interpretadas de forma semelhante, se não de forma idêntica, como estimativa do efeito total.[@Westreich2013; @bandoli2018]

-   A falácia da Tabela 2 pode ser evitada limitando-se a tabela a estimativas das medidas primárias do efeito de exposição nos diferentes modelos, com as covariáveis secundárias de "ajuste" relatadas em uma nota de rodapé, juntamente com a forma como foram categorizadas ou modeladas.[@Westreich2013]

<br>

```{r falacia-tabela-2, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Exemplo clássico suscetível à Falácia da Tabela 2. A Tabela apresenta a razão de chances (OR) bruta entre grupo e sexo (modelo sem covariáveis)e a OR ajustada entre grupo e sexo, controlando por idade e IMC (modelo com covariáveis)."}
# Reprodutibilidade
set.seed(123)

# Exemplo simulado
dados <- tibble::tibble(
  Grupo = sample(c("Controle", "Intervenção"), 200, TRUE),
  Sexo  = sample(c("F", "M"), 200, TRUE),
  Idade = round(rnorm(200, 60, 12), 1),
  IMC   = round(rnorm(200, 27, 4), 1)
) |>
  dplyr::mutate(
    # garantir referências "Controle" e "M"
    Grupo = factor(Grupo, levels = c("Controle", "Intervenção")),
    Sexo  = factor(Sexo,  levels = c("M", "F"))
  )

# Modelos: cru vs ajustado
mod_cru <- glm(I(Sexo == "F") ~ Grupo,
               data = dados, family = binomial)

mod_aj  <- glm(I(Sexo == "F") ~ Grupo + Idade + IMC,
               data = dados, family = binomial)

# Tabelas com gtsummary
gtsummary::theme_gtsummary_language("pt")

tab_cru <- gtsummary::tbl_regression(
  mod_cru, exponentiate = TRUE
) |>
  gtsummary::modify_caption("**Tabela 2a. OR bruto (modelo sem covariáveis).**")

tab_aj <- gtsummary::tbl_regression(
  mod_aj, exponentiate = TRUE
) |>
  gtsummary::modify_caption("**Tabela 2b. OR ajustado (inclui covariáveis).**")

tab_falacia <- gtsummary::tbl_merge(
  list(tab_cru, tab_aj),
  tab_spanner = c("**Sem ajuste**", "**Ajustado**")
) |>
  gtsummary::modify_caption("**Tabela 2. (Exemplo clássico suscetível à Falácia da Tabela 2).**")

tab_falacia
```

<br>

### Como construir a 'Tabela 2'?

-   A Tabela 2 pode ser utilizada para apresentar estimativas de múltiplos efeitos ajustados de um mesmo modelo estatístico.[@Westreich2013]

<br>

```{r tabela-2, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Exemplo clássico suscetível à Falácia da Tabela 2. A Tabela 2 apresenta a razão de chances (OR) bruta entre grupo e sexo (modelo sem covariáveis) e ajustada entre grupo e sexo, controlando por idade e IMC (modelo com covariáveis)."}
# Reprodutibilidade
set.seed(123)

# Exemplo simulado
dados <- tibble::tibble(
  Grupo = sample(c("Controle", "Intervenção"), 200, TRUE),
  Sexo  = sample(c("F", "M"), 200, TRUE),
  Idade = round(rnorm(200, 60, 12), 1),
  IMC   = round(rnorm(200, 27, 4), 1)
) |>
  dplyr::mutate(
    # garantir referências "Controle" e "M"
    Grupo = factor(Grupo, levels = c("Controle", "Intervenção")),
    Sexo  = factor(Sexo, levels = c("M", "F"))
  )

# Modelos: cru vs ajustado
mod_cru <- glm(I(Sexo == "F") ~ Grupo, data = dados, family = binomial)

mod_aj  <- glm(I(Sexo == "F") ~ Grupo + Idade + IMC,
               data = dados,
               family = binomial)

# Tabelas com gtsummary
gtsummary::theme_gtsummary_language("pt")

tab_cru <- gtsummary::tbl_regression(mod_cru, exponentiate = TRUE, include = "Grupo")

tab_aj <- gtsummary::tbl_regression(mod_aj, exponentiate = TRUE, include = "Grupo")

tab_anti <- gtsummary::tbl_merge(list(tab_cru, tab_aj),
                                 tab_spanner = c("**Sem ajuste**", "**Ajustado**")) |>
  gtsummary::modify_caption("**Tabela 2. Exposição (OR; 95% IC) com e sem ajuste.**")

# adiciona a nota de rodapé (corrigindo o erro)
tab_anti_gt <- gtsummary::as_gt(tab_anti) |>
  gt::tab_source_note(
    gt::md(
      "**Nota.** Modelo ajustado por Idade (contínua) e IMC (contínuo).
 Covariáveis são usadas apenas para controle de confusão e não devem ser interpretadas como efeitos causais (*Falácia da Tabela 2*)."
    )
  )

tab_anti_gt
```

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *table1*[@table1] fornece a função [*table1*](https://search.r-project.org/CRAN/refmans/table1/html/table1.html) para construção de tabelas.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *gtsummary*[@gtsummary] fornece a função [*tbl_summary*](https://search.r-project.org/CRAN/refmans/gtsummary/html/tbl_summary.html) para construção da 'Tabela 1' com dados descritivos.
:::

<br>

## Visualização efetiva de dados

<br>

### Por que começar pela mensagem antes do gráfico?

-   A figura deve responder a uma pergunta clara (comparação? tendência? composição?) e isso orienta a escolha do tipo de gráfico, dados e anotações. Esboce a mensagem e a pergunta antes de abrir o software.[@midway2020]

### Como escolher a geometria e “mostrar os dados”?

-   Prefira geometrias que revelem distribuição/variabilidade (pontos, *boxplots*, violinos) em vez de médias sozinhas. Sempre que possível, **exiba os dados brutos** (pontos com *jitter*) junto da estatística-resumo.[@midway2020]

<br>

```{r viz-geom-mostrar-dados, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Exemplo de gráfico que mostra os dados brutos junto com um resumo estatístico (média e dispersão)."}
# Reprodutibilidade
set.seed(1)

# Gerar dados de exemplo
df <- tibble::tibble(
  grupo = rep(c("Controle","Intervenção"), each = 40),
  y = c(rnorm(40, 10, 2), rnorm(40, 11.5, 2.5))
)

ggplot2::ggplot(df, ggplot2::aes(grupo, y, fill = grupo)) +
  ggplot2::geom_violin(alpha=.3, color=NA, trim=FALSE) +
  ggplot2::geom_boxplot(width=.15, outlier.shape = NA) +
  ggplot2::geom_jitter(width=.08, alpha=.6, size=1.6) +
  ggplot2::labs(x=NULL, y="Desfecho (unid.)",
                title="Mostrar dados + resumo > apenas médias") +
  ggplot2::theme_minimal() +
  ggplot2::guides(fill="none")
```

<br>

## Gráficos

<br>

### O que são gráficos?

-   Gráficos são utilizados para apresentar dados (geralmente em grande quantidade) de modo mais intuitivo e fácil de compreender.[@Park2022]

<br>

### O que torna um bom gráfico tão poderoso?

-   “Não há ferramenta estatística tão poderosa quanto um gráfico bem escolhido”: gráficos ajudam a explorar dados, comunicar resultados e suportar decisões de forma clara e rápida.[@vandemeulebroecke2018]

<br>

### Que elementos incluir em gráficos?

-   Título, eixos horizontal e vertical com respectivas unidades, escalas em intervalos representativos das variáveis, legenda com símbolos, síntese descritiva dos valores e respectiva margem de erro, conforme necessário para adequada interpretação.[@Park2022]

<br>

### Para que servem as barras de erro em gráficos?

-   Barras de erro ajudam ao autor a apresentar as informações que descrevem os dados (por exemplo, em uma análise descritiva) ou sobre as inferências ou conclusões tomadas a partir de dados.[@Cumming2007; @krzywinski2013]

-   Barras de erro mais longas representam mais imprecisão (maiores erros), enquanto barras mais curtas representam mais precisão na estimativa.[@Cumming2007]

-   Barras de erro descritivas geralmente apresentam a amplitude (mínimo-máximo) ou desvio-padrão.[@Cumming2007]

-   Barras de erro inferenciais geralmente apresentam o erro-padrão ou intervalo de confiança no nível de significância $\alpha$ pré-estabelecido.[@Cumming2007; @krzywinski2013]

-   Barras de erro com desvio-padrão são úteis para descrever a variabilidade dos dados, enquanto as barras de erro com erro padrão da média são úteis para descrever a precisão do parâmetro estimado (média) e sua relação com o tamanho da amostra.[@krzywinski2013]

-   Barras de erro com intervalo de confiança são úteis para fornecer uma estimativa da incerteza da estimativa do parâmetro populacional.[@krzywinski2013]

-   O comprimento das barras de erro sugere graficamente a imprecisão dos dados do estudo, uma vez que o valor verdadeiro da população pode estar em qualquer nível do intervalo da barra.[@Cumming2007]

-   De modo contraintuitivo, um espaço entre as barras não garante significância, nem a sobreposição a descarta—depende do tipo de barra.[@krzywinski2013]

-   Para amostras pequenas é preferível apresentar os dados brutos, uma vez que as barras de erro não serão muito informativas.[@krzywinski2013]

<br>

```{r barras-erro-simples, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Exemplos de gráficos com barras de erro e dados brutos."}
# Reprodutibilidade
set.seed(42)

# Gerar dados de exemplo
g1 <- rnorm(10, 100, 12)
g2 <- rnorm(16, 106, 20)
d  <- data.frame(value=c(g1,g2), group=rep(c("G1","G2"), c(length(g1),length(g2))))

se_fun <- function(z){ m <- mean(z); se <- sd(z)/sqrt(length(z)); c(y=m, ymin=m-se, ymax=m+se) }
sd_fun <- function(z){ m <- mean(z); sdv <- sd(z); c(y=m, ymin=m-sdv, ymax=m+sdv) }

# Média ± SE
p1 <- ggplot2::ggplot(d, ggplot2::aes(group, value)) +
  ggplot2::stat_summary(fun=mean, geom="bar") +
  ggplot2::stat_summary(fun.data=se_fun, geom="errorbar", width=.2) +
  ggplot2::ggtitle("Média ± SE")

# Média ± SD
p2 <- ggplot2::ggplot(d, ggplot2::aes(group, value)) +
  ggplot2::stat_summary(fun=mean, geom="bar") +
  ggplot2::stat_summary(fun.data=sd_fun, geom="errorbar", width=.2) +
  ggplot2::ggtitle("Média ± SD")

# Dispersão univariada (recomendado)
p3 <- ggplot2::ggplot(d, ggplot2::aes(group, value)) +
  ggplot2::geom_point(position=ggplot2::position_jitter(width=.08, height=0), alpha=.85) +
  ggplot2::ggtitle("Dispersão (um ponto por observação)")

# Combinar em 3 painéis horizontais
library(patchwork)
p1 + p2 + p3
```

<br>

```{r barras-erro, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Exemplos de gráficos com barras de erro e dados brutos em diferentes cenários."}
# Reprodutibilidade
set.seed(123)

n1 <- 8; n2 <- 8

# Cenário A: ambos ~N(0,1)
A1 <- rnorm(n1, 5, 1); A2 <- rnorm(n2, 6, 1)

# Cenário B: diferença “criada” por um outlier
B1 <- rnorm(n1, 5.2, 1); B2 <- c(rnorm(n2-1, 5.3, 1), 9.5)

# Cenário C: bimodal em um grupo
C1 <- c(rnorm(n1/2, 4.5, .5), rnorm(n1/2, 6, .5)); C2 <- rnorm(n2, 5.5, .8)

make_df <- function(x,y,lab) tibble::tibble(value=c(x,y), group=rep(c("G1","G2"), c(length(x),length(y))), scen=lab)
df <- dplyr::bind_rows(
  make_df(A1,A2,"A: Normal vs Normal"),
  make_df(B1,B2,"B: Outlier"),
  make_df(C1,C2,"C: Bimodal")
)

library(patchwork)

# Barras (média ± SE)
p_bar <- ggplot2::ggplot(df, ggplot2::aes(group, value)) +
  ggplot2::stat_summary(fun=mean, geom="bar") +
  ggplot2::stat_summary(fun.data=\(z) c(y=mean(z), 
                               ymin=mean(z)-sd(z)/sqrt(length(z)), 
                               ymax=mean(z)+sd(z)/sqrt(length(z))), 
               geom="errorbar", width=.2) +
  ggplot2::facet_wrap(~scen) +
  ggplot2::ggtitle("Média ± SE (Barras)")

# Dispersões
p_disp <- ggplot2::ggplot(df, ggplot2::aes(group, value)) +
  ggplot2::geom_point(position=ggplot2::position_jitter(width=.08, height=0), alpha=.8) +
  ggplot2::facet_wrap(~scen) +
  ggplot2::ggtitle("Dispersão dos Dados (Pontos)")

# Combinar em 2 painéis verticais
p_bar / p_disp
```

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
Os pacotes *ggplot2*[@ggplot2], *plotly*[@plotly] e *corrplot*[@corrplot] fornecem diversas funções para construção de gráficos tais como [*ggplot*](https://www.rdocumentation.org/packages/ggplot2/versions/3.4.3/topics/ggplot), [*plot_ly*](https://www.rdocumentation.org/packages/plotly/versions/4.10.2/topics/plot_ly) e [*corrplot*](https://www.rdocumentation.org/packages/corrplot/versions/0.92/topics/corrplot) respectivamente.
:::

<br>

### Quais são os principais obstáculos para bons gráficos?

-   Dificuldade técnica, negligência no ensino tradicional e o foco em “beleza” sem clareza podem levar a gráficos ruins, mesmo quando bem intencionados.[@vandemeulebroecke2018]

<br>

## Tipos de gráficos

<br>

### Quais são os tipos de gráficos para variáveis categóricas?

-   Gráfico de barras: Mais usado para comparar frequências absolutas ou relativas entre categorias.[@REF]

<br>

```{r graficos-var-categoricas, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico de barras simples representando frequências por categoria."}
# Criar um conjunto de dados de exemplo
dados <- data.frame(
  Grupo = rep(c("A", "B", "C"), each = 3),
  Categoria = rep(c("X", "Y", "Z"), times = 3),
  Contagem = c(30, 20, 10, 25, 15, 5, 20, 10, 10)
)

# Frequência por Categoria (soma total de contagens)
dados_barras <- dados %>%
  dplyr::group_by(Categoria) %>%
  dplyr::summarise(Total = sum(Contagem))

ggplot2::ggplot(dados_barras, ggplot2::aes(x = Categoria, y = Total, fill = Categoria)) +
  ggplot2::geom_bar(stat = "identity") +
  ggplot2::labs(title = "Gráfico de Barras Simples",
       x = "Categoria", y = "Frequência Total") +
  ggplot2::theme_minimal()
```

<br>

-   Gráfico de barras empilhadas: Útil para comparar proporções entre grupos em mais de uma variável categórica.[@REF]

<br>

```{r graficos-var-categoricas-empilhados, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico de barras empilhadas representando frequências por categoria."}
# Criar um conjunto de dados de exemplo
dados <- data.frame(
  Grupo = rep(c("A", "B", "C"), each = 3),
  Categoria = rep(c("X", "Y", "Z"), times = 3),
  Contagem = c(30, 20, 10, 25, 15, 5, 20, 10, 10)
)

# Frequência por Categoria (soma total de contagens)
dados_barras <- dados %>%
  dplyr::group_by(Categoria) %>%
  dplyr::summarise(Total = sum(Contagem))

ggplot2::ggplot(dados, ggplot2::aes(x = Grupo, y = Contagem, fill = Categoria)) +
  ggplot2::geom_bar(stat = "identity") +
  ggplot2::labs(title = "Gráfico de Barras Empilhadas",
       x = "Grupo", y = "Contagem") +
  ggplot2::theme_minimal()
```

<br>

```{r bar-plot, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráficos de barras represetando médias, barras de erro e dados individuais."}
# Gerar dados de exemplo
set.seed(123)
df <- base::expand.grid(Fator1 = c("A", "B"),
                        Fator2 = c("X", "Y"),
                        Rep = 1:15) |>
  dplyr::mutate(Y = stats::rnorm(dplyr::n(), 
                                 mean = dplyr::if_else(Fator1 == "A", 5, 7) + dplyr::if_else(Fator2 == "X", 0, 2), 
                                 sd = 1.5))

# Calcular estatísticas por grupo
summary_df <- df |>
  dplyr::group_by(Fator1, Fator2) |>
  dplyr::summarise(
    media = mean(Y),
    sd = stats::sd(Y),
    n = dplyr::n(),
    se = sd / sqrt(n),
    ic95 = 1.96 * se,
    .groups = "drop"
  )

# 1. Gráfico com apenas as médias
p1 <- ggplot2::ggplot(summary_df, ggplot2::aes(x = interaction(Fator1, Fator2), y = media, fill = Fator1)) +
  ggplot2::geom_bar(stat = "identity", position = ggplot2::position_dodge(), width = 0.6) +
  ggplot2::labs(title = "Média", y = "Média", x = "Grupo") +
  ggplot2::theme_minimal()

# 2. Gráfico com média + intervalo de confiança
p2 <- ggplot2::ggplot(summary_df, ggplot2::aes(x = interaction(Fator1, Fator2), y = media, fill = Fator1)) +
  ggplot2::geom_bar(stat = "identity", position = ggplot2::position_dodge(), width = 0.6) +
  ggplot2::geom_errorbar(ggplot2::aes(ymin = media - ic95, ymax = media + ic95), width = 0.2) +
  ggplot2::labs(
    title = "Média com Intervalo de Confiança",
    subtitle = "Barras de erro representam IC 95%",
    y = "Média", x = "Grupo"
  ) +
  ggplot2::theme_minimal()

# 3. Gráfico com média + pontos individuais
p3 <- ggplot2::ggplot(df, ggplot2::aes(x = interaction(Fator1, Fator2), y = Y, fill = Fator1)) +
  ggplot2::stat_summary(fun = mean, geom = "bar", width = 0.6, color = "black") +
  ggplot2::geom_jitter(position = ggplot2::position_jitter(width = 0.1), shape = 21, color = "black", size = 2, alpha = 0.6) +
  ggplot2::labs(
    title = "Média e Pontos Individuais",
    subtitle = "Pontos representam dados individuais",
    y = "Valor", x = "Grupo"
  ) +
  ggplot2::guides(fill = "none") +  # <- oculta a legenda
  ggplot2::theme_minimal()

# Empilhar os gráficos verticalmente
library(patchwork)
(p1 / p2 / p3) + patchwork::plot_layout(guides = "collect")
```

<br>

### Quais são os tipos de gráficos para variáveis numéricas?

-   Histograma: Distribuição de frequência de uma variável contínua. Mostra a forma da distribuição (simétrica, assimétrica, bimodal).[@REF]

<br>

```{r graficos-var-numericas, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Histograma da variável 'valor'."}
# Simular dados
dados <- data.frame(valor = stats::rnorm(1000, mean = 50, sd = 10))

# Histograma
ggplot2::ggplot(dados, ggplot2::aes(x = valor)) +
  ggplot2::geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
  ggplot2::labs(title = "Histograma da variável 'valor'",
                x = "Valor", y = "Frequência") +
  ggplot2::theme_minimal()
```

<br>

-   Gráfico de densidade: Similar ao histograma, mas mais suave. Útil para avaliar a distribuição.[@REF]

<br>

```{r grafico-densidade, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico de densidade da variável 'valor'."}
# Simular dados
dados <- data.frame(valor = stats::rnorm(1000, mean = 0, sd = 1))

# Gráfico de densidade
ggplot2::ggplot(dados, ggplot2::aes(x = valor)) +
  ggplot2::geom_density(fill = "lightblue", alpha = 0.6) +
  ggplot2::labs(title = "Gráfico de Densidade da variável 'valor'",
                x = "Valor", y = "Densidade") +
  ggplot2::theme_minimal()
```

<br>

-   Diagrama de caixa (*boxplot*): Resume mediana, quartis e valores extremos. Excelente para comparar grupos.[@REF]

<br>

```{r boxplot-grupos, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Boxplot por grupo."}
# Simular dados com dois grupos
dados <- data.frame(
  grupo = rep(c("Controle", "Tratamento"), each = 100),
  medida = c(stats::rnorm(100, mean = 50, sd = 5),
             stats::rnorm(100, mean = 55, sd = 7))
)

# Boxplot
ggplot2::ggplot(dados, ggplot2::aes(x = grupo, y = medida, fill = grupo)) +
  ggplot2::geom_boxplot() +
  ggplot2::labs(title = "Boxplot por grupo",
                x = "Grupo", y = "Medida") +
  ggplot2::theme_minimal()
```

<br>

-   Gráfico de violino: Combina boxplot e densidade, mostrando a distribuição da variável. Útil para comparar grupos.[@REF]

<br>

```{r violin-plot, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Violin plot por grupo."}
# Simular dados com dois grupos
dados <- data.frame(
  grupo = rep(c("Controle", "Tratamento"), each = 100),
  medida = c(stats::rnorm(100, mean = 50, sd = 5),
             stats::rnorm(100, mean = 55, sd = 7))
)

# Violin plot
ggplot2::ggplot(dados, ggplot2::aes(x = grupo, y = medida, fill = grupo)) +
  ggplot2::geom_violin(trim = FALSE, alpha = 0.6) +
  ggplot2::geom_boxplot(width = 0.1, fill = "white", outlier.shape = NA) +
  ggplot2::labs(title = "Violin Plot por Grupo",
                x = "Grupo", y = "Medida") +
  ggplot2::theme_minimal()
```

<br>

-   Gráfico de pontos (*dot plot*): Mostra cada valor individualmente, útil para pequenas amostras e para visualizar a distribuição.[@REF]

<br>

```{r grafico-pontos, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico de pontos da variável 'valor'."}
# Simular dados
set.seed(123)
dados <- data.frame(
  grupo = rep(c("Controle", "Tratamento"), each = 20),
  medida = c(stats::rnorm(20, mean = 50, sd = 5),
             stats::rnorm(20, mean = 55, sd = 5))
)

# Dot plot
ggplot2::ggplot(dados, ggplot2::aes(x = grupo, y = medida, color = grupo)) +
  ggplot2::geom_dotplot(binaxis = "y", stackdir = "center", dotsize = 0.7) +
  ggplot2::labs(title = "Dot Plot por Grupo",
                x = "Grupo", y = "Medida") +
  ggplot2::theme_minimal()
```

<br>

### Quais são os tipos de gráficos para relações entre variáveis?

-   Gráfico de dispersão (*scatter plot*): Mostra a relação entre duas variáveis quantitativas. Ideal para investigar correlações.[@REF]

<br>

```{r graficos-relacoes, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico de dispersão representando a relação entre duas variáveis."}
# Simular dados
dados <- data.frame(
  x = stats::rnorm(100, mean = 50, sd = 10),
  y = 2 * stats::rnorm(100, mean = 50, sd = 10) + 10
)

# Gráfico de dispersão
ggplot2::ggplot(dados, ggplot2::aes(x = x, y = y)) +
  ggplot2::geom_point(color = "darkblue", alpha = 0.7) +
  ggplot2::labs(title = "Gráfico de Dispersão",
                x = "Variável X", y = "Variável Y") +
  ggplot2::theme_minimal()
```

<br>

-   Gráfico de bolhas (*bubble chart*): Expande o gráfico de dispersão adicionando uma terceira variável (tamanho da bolha).[@REF]

<br>

```{r graficos-bolhas, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico de bolhas representando a relação entre três variáveis."}
# Simular dados com três variáveis
dados <- data.frame(
  x = stats::rnorm(100, 10, 3),
  y = stats::rnorm(100, 20, 5),
  z = abs(stats::rnorm(100, 5, 2)) # Tamanho da bolha (positivo)
)

# Gráfico de bolhas
ggplot2::ggplot(dados, ggplot2::aes(x = x, y = y, size = z)) +
  ggplot2::geom_point(alpha = 0.6, color = "purple") +
  ggplot2::labs(title = "Gráfico de Bolhas",
                x = "Eixo X", y = "Eixo Y", size = "Variável Z") +
  ggplot2::theme_minimal()
```

<br>

### Quais são os tipos de gráficos para dados longitudinais?

-   Gráfico de *spaghetti*: Mostra trajetórias individuais ao longo do tempo, útil para dados longitudinais.[@REF]

<br>

```{r graficos-longitudinais, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico spaghetti representando dados longitudinais."}
# Reprodutibilidade
set.seed(1)

# Simular dados longitudinais
n <- 15
id <- factor(seq_len(n))
pre  <- rnorm(n, 50, 6)
post <- pre + rnorm(n, 3, 4)   # efeito médio ~3, mas heterogêneo

dfp <- data.frame(
    id,
    time = factor(rep(c("Pré","Pós"), each=n), levels=c("Pré","Pós")),
    value = c(pre, post)
)

# Linhas por sujeito (spaghetti plot)
ggplot2::ggplot(dfp, ggplot2::aes(time, value, group=id)) +
    ggplot2::geom_point() +
    ggplot2::geom_line(alpha=.6) +
    ggplot2::labs(x=NULL, y="Valor")
```

<br>

### Quais são os tipos de gráficos para séries temporais?

-   Gráfico de linhas: Mostra a evolução de uma variável ao longo do tempo, com pontos conectados por linhas.[@REF]

<br>

```{r grafico-linha, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico de linha representando uma série temporal."}
# Simular série temporal
set.seed(42)
tempo <- seq.Date(from = as.Date("2025-01-01"), by = "day", length.out = 100)
medida <- cumsum(stats::rnorm(100, mean = 0.2, sd = 1))
dados <- data.frame(data = tempo, valor = medida)

# Gráfico de linha com pontos
ggplot2::ggplot(dados, ggplot2::aes(x = data, y = valor)) +
  ggplot2::geom_line(color = "darkgreen") +
  ggplot2::geom_point(color = "black", size = 1.5) +
  ggplot2::labs(title = "Série Temporal Simulada",
                x = "Data", y = "Valor") +
  ggplot2::theme_minimal()
```

<br>

### Quais são os tipos de gráficos para dados multivariados?

-   Gráfico de dispersão: Representa a relação entre duas variáveis, com pontos e uma linha de tendência.[@REF]

<br>

```{r graficos-correlacao, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico de correlação entre duas variáveis com linha de tendência."}
# Simular dados com correlação
set.seed(1)
x <- stats::rnorm(100)
y <- 2 * x + stats::rnorm(100, sd = 0.5)
dados <- data.frame(x = x, y = y)

# Gráfico de dispersão com linha de tendência
ggplot2::ggplot(dados, ggplot2::aes(x = x, y = y)) +
  ggplot2::geom_point(color = "darkblue", alpha = 0.6) +
  ggplot2::geom_smooth(method = "lm", color = "red", se = FALSE) +
  ggplot2::labs(title = "Correlação entre Variáveis",
                x = "Variável X", y = "Variável Y") +
  ggplot2::theme_minimal()
```

<br>

-   Gráfico de matriz de dispersão: Mostra relações entre múltiplas variáveis quantitativas, útil para identificar padrões.[@REF]

<br>

```{r graficos-matriz-dispersao, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Matriz de dispersão representando relações entre múltiplas variáveis."}
# Instalar se necessário: install.packages("GGally")
library(GGally)

# Simular dados multivariados
dados <- data.frame(
  var1 = stats::rnorm(100),
  var2 = stats::rnorm(100, mean = 50, sd = 10),
  var3 = stats::rnorm(100, mean = 100, sd = 25)
)

# Matriz de dispersão
GGally::ggpairs(dados, title = "Matriz de Dispersão")
```

<br>

-   Gráfico de calor (*heatmap*): Representa dados em uma matriz, com cores indicando intensidade ou frequência.[@REF]

<br>

```{r graficos-heatmap, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Mapa de calor da correlação entre variáveis."}
# Simular matriz de correlação
set.seed(2)
dados <- data.frame(
  A = stats::rnorm(50),
  B = stats::rnorm(50, mean = 5),
  C = stats::rnorm(50, mean = 10, sd = 3)
)
matriz_cor <- stats::cor(dados)

# Converter para formato longo e renomear variáveis
library(reshape2)
dados_long <- reshape2::melt(matriz_cor)
names(dados_long) <- c("Variável 1", "Variável 2", "Correlação")

# Heatmap com nomes atualizados (sem aspas em aes)
ggplot2::ggplot(dados_long, ggplot2::aes(x = `Variável 1`, y = `Variável 2`, fill = Correlação)) +
  ggplot2::geom_tile(color = "white") +
  ggplot2::scale_fill_gradient2(low = "blue", high = "red", mid = "white",
                                midpoint = 0, limit = c(-1, 1), name = "Correlação") +
  ggplot2::labs(title = "Mapa de Calor da Correlação entre Variáveis") +
  ggplot2::theme_minimal()
```

<br>

-   Gráfico de radar (ou gráfico de aranha): Representa várias variáveis em um único gráfico, útil para comparar perfis.[@REF]

<br>

```{r graficos-multivariados, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Gráfico radar representando múltiplas variáveis."}
# Simular dados para 3 perfis com 5 variáveis
dados <- data.frame(
  Max = c(10, 10, 10, 10, 10),
  Min = c(0, 0, 0, 0, 0),
  Perfil_A = c(6, 7, 8, 5, 9),
  Perfil_B = c(8, 6, 7, 6, 7),
  Perfil_C = c(5, 9, 6, 8, 6)
)
rownames(dados) <- c("Max", "Min", "A", "B", "C")

# Gráfico radar
fmsb::radarchart(dados,
                 axistype = 1,
                 pcol = c("red", "blue", "green"),
                 plty = 1,
                 title = "Gráfico de Radar - Perfis Simulados")
```

<br>

### Quais são as boas práticas na elaboração de gráficos?

-   O tamanho da amostra total e subgrupos, se houver, deve estar descrito na figura ou na sua legenda.[@Cumming2007]

-   Para análise inferencial de figuras, as barras de erro representadas por erro-padrão ou intervalo de confiança no nível de significância $\alpha$ pré-estabelecido são preferíveis à amplitude ou desvio-padrão.[@Cumming2007; @krzywinski2013]

-   Evite gráficos de barra e mostre a distribuição dos dados sempre que possível.[@Weissgerber2019]

-   Exiba os pontos de dados em boxplots.[@Weissgerber2019]

-   Use *jitter* simétrico em gráficos de pontos para permitir a visualização de todos os dados.[@Weissgerber2019]

-   Prefira palhetas de cor adaptadas para daltônicos.[@Weissgerber2019]

-   Uma boa legenda torna a figura autossuficiente: descreva amostra (n), geometrias, métricas de incerteza, escalas/unidades e mensagem principal. Se houver modelo, indique fórmula/ajustes em nota.[@midway2020]

-   Evite gráficos de barras com médias para variáveis contínuas; prefira pontos/box/violino e, em amostras pequenas, exiba todos os dados.[@Weissgerber2019]

-   Antes de finalizar um gráfico, faça as seguintes perguntas: (1) Mensagem está explícita? (2) Geometria adequada e dados visíveis? (3) Incerteza correta e rotulada? (4) Cores informativas e acessíveis? (5) Escalas comparáveis (se facetou)? (6) Legenda/caption autossuficiente? (7) Diferença clara entre dados e modelos? (8) Arquivo exportado na resolução/tamanho exigidos?[@midway2020]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *ggsci*[@ggsci] fornece palhetas de cores tais como [*pal_lancet*](https://www.rdocumentation.org/packages/ggsci/versions/3.0.0/topics/pal_lancet), [*pal_nejm*](https://www.rdocumentation.org/packages/ggsci/versions/3.0.0/topics/pal_nejm) e [*pal_npg*](https://www.rdocumentation.org/packages/ggsci/versions/3.0.0/topics/pal_npg) inspiradas em publicações científicas para uso em gráficos.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *grDevices*[@grDevices] fornece a função [*dev.new*](https://www.rdocumentation.org/packages/grDevices/versions/3.6.2/topics/dev) para controlar diversos aspectos do gráfico, tais como tamanho e resolução.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *tiff*[@tiff] fornece a função [*writeTIFF*](https://www.rdocumentation.org/packages/tiff/versions/0.1-11/topics/writeTIFF) para exportar gráficos em formato TIFF.
:::

<br>

## Gráficos dinâmicos

<br>

### O que são visualizações dinâmicas?

-   Visualizações dinâmicas combinam interatividade (exploração ativa pelo leitor) e animação (mudanças ao longo do tempo/iterações) para empacotar informação rica em exibições simples, tornando comunicação e exploração mais transparentes.[@wiebels2023]

<br>

### Quando preferir interatividade?

-   Durante exploração de dados em equipe: destacar pontos/linhas por participante, filtrar subconjuntos e inspecionar impactos de escolhas analíticas (p.ex., outliers) sem gerar múltiplas figuras novas.[@wiebels2023]

<br>

```{r grafico-interativo, echo=FALSE, warning=FALSE, message=FALSE, appendix=TRUE, fig.align='center', layout='Blank', ph=officer::ph_location_fullsize(), results='asis', fig.fullwidth=TRUE, fig.cap='Exemplo de gráfico interativo com Plotly.'}
library(dplyr)

g <- tibble::tibble(
  grupo = rep(c("Controle", "Intervenção"), each = 40),
  semana = rep(c(1, 5, 16, 20), times = 20),
  y = rnorm(80, 12, 2) + ifelse(grupo == "Intervenção" &
                                  semana >= 16, 2, 0)
)

plotly::plot_ly(
  g,
  y =  ~ y,
  x =  ~ as.factor(semana),
  color =  ~ grupo,
  type = "box"
) %>%
  plotly::layout(
    boxmode = "group",
    xaxis = list(title = "Semana"),
    yaxis = list(title = "Desempenho")
  ) %>%
  plotly::add_trace(
    type = "scatter",
    mode = "markers",
    hoverinfo = "x+y+text",
    text =  ~ paste("Grupo:", grupo)
  )
```

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *plotly*[@plotly] fornece a função [*plot_ly*](https://www.rdocumentation.org/packages/plotly/versions/4.11.0/topics/plot_ly) para gerar gráficos interativos.
:::

<br>

### Quando preferir animação?

-   Em apresentações e para ilustrar variação ao longo de tempo/condição/algoritmo, evitando painéis 3D ou facets excessivos. A animação guia a atenção e revela mudanças de forma passiva e fluida.[@wiebels2023]

<br>

```{r grafico-animado, echo=FALSE, warning=FALSE, message=FALSE, appendix=TRUE, fig.align='center', layout='Blank', ph=officer::ph_location_fullsize(), results='asis', fig.fullwidth=TRUE, fig.cap='Exemplo de gráfico animado com gganimate.'}
# # Reprodutibilidade
# set.seed(123)
# 
# # Simular dados
# d <- tibble::tibble(
#   tp = factor(rep(1:3, each = 80)),
#   x = rnorm(240, 2000, 400),
#   y = x + rnorm(240, 400, 300)
# )
# 
# # Gráfico animado
# p <- ggplot2::ggplot(d, ggplot2::aes(x, y, color = tp)) +
#   ggplot2::geom_point(alpha = .5) +
#   ggplot2::geom_smooth(method = "lm", se = FALSE) +
#   ggplot2::labs(x = "Tempo (passado)", y = "Tempo (futuro)") +
#   gganimate::transition_states(tp, wrap = FALSE) + gganimate::shadow_mark()
# 
# # Se HTML → salva GIF e mostra
# if (knitr::is_html_output()) {
#   anim <- gganimate::animate(p,
#                              end_pause = 20,
#                              width = 600,
#                              height = 400)
#   gganimate::anim_save("../images/animacao.gif", animation = anim)
#   knitr::include_graphics("../images/animacao.gif")
# }
# 
# # Se PDF → salva um frame estático (PNG)
# if (knitr::is_latex_output()) {
#   anim <- gganimate::animate(
#     p,
#     end_pause = 20,
#     nframes = 1,
#     width = 600,
#     height = 400
#   )
#   gganimate::anim_save("../images/animacao_frame.png", animation = anim)
#   knitr::include_graphics("../images/animacao_frame.png")
# }
```

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *gganimate*[@gganimate] fornece a função [*transition_states*](https://www.rdocumentation.org/packages/gganimate/versions/1.0.7/topics/transition_states) para criar gráficos animados a partir de gráficos estáticos do *ggplot2*[@ggplot2].
:::

<br>

```{r, echo=FALSE, warning=FALSE, results='asis', eval=knitr::is_html_output()}
cat(readLines("citation.html"), sep = "\n")
```

<br>
