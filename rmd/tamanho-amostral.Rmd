# **Tamanho da amostra** {#tamanho-amostral}

<br>

## Tamanho da amostra

<br>

### O que é tamanho da amostra?

-   Tamanho da amostra $n$ é a quantidade de participantes (ou unidades de análise) necessárias para conduzir um estudo a fim de testar uma hipótese.[@rodríguezdeláguila2014]

-   O cálculo do tamanho da amostra depende de quatro pilares interligados — tamanho de efeito esperado, variabilidade, nível de significância ($\alpha$) e poder ($1-\beta$) — cuja combinação determina o $n$ necessário para detectar efeitos de interesse com precisão adequada.[@Banerjee2010]

<br>

### Por que determinar o tamanho da amostra é importante?

-   É virtualmente impossível, devido a limitações de recursos --- tempo, acesso, custo, dentre outros --- coletar dados da população completa.[@kwak2017]

-   Uma amostra muito pequena para o estudo pode resultar em ajuste exagerado, imprecisão e baixo poder do teste.[@van2022a]

<br>

### Quais fatores devem ser considerados para determinar o tamanho da amostra?

-   Tamanho da população ($N$): O tamanho da amostra depende parcialmente do tamanho da população de origem. Geralmente assume-se que a população tem tamanho desconhecido ou infinito. Em alguns estudos serão amostradas populações de tamanho finito (inferior a 100.000 indivíduos), geralmente em pesquisas descritivas, em que esse tamanho deve ser incorporado nos cálculos.[@rodríguezdeláguila2014]

-   Delineamento do estudo.[@rodríguezdeláguila2014]

-   Quantidade e características (dependente vs. independente) dos grupos de participantes do estudo.[@rodríguezdeláguila2014]

-   Erros tipo I ($\alpha$) e tipo II ($\beta$).[@rodríguezdeláguila2014]

-   Tipo de variável a ser observada (contínua, intervalo, ordinal, nominal, dicotômica).[@rodríguezdeláguila2014]

-   Tamanho de efeito mínimo a ser observado.[@rodríguezdeláguila2014]

-   Variabilidade da(s) variável(eis) coletada(s).[@rodríguezdeláguila2014]

-   Lateralidade do teste de hipótese (uni- ou bicaudais).[@rodríguezdeláguila2014]

-   Perdas de dados durante a coleta e/ou acompanhamento dos participantes do estudo.[@rodríguezdeláguila2014]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*plot.power.htest*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/plot.power.htest) para apresentar graficamente a relação entre o tamanho da amostra e o poder de testes de hipóteses.
:::

<br>

### Quais aspectos éticos estão envolvidos no tamanho da amostra?

-   Determinar a priori o tamanho da amostra pode diminuir o risco de realizar testes ou intervenções desnecessários, de desperdício de recursos (tempo e dinheiro) associados e, por outro lado, de coletar dados insuficientes para testar as hipóteses do estudo.[@rodríguezdeláguila2014]

-   O tratamento ético dos participantes do estudo, portanto, não exige que se considere se o poder do estudo é inferior à meta convencional de 80% ou 90%.[@Bacchetti2005]

-   Estudos com poder \<80% não são necessariamente antiéticos.[@Bacchetti2005]

-   Metas convencionais de poder (80–90%) são guias pragmáticos e não regras morais rígidas; estudos com poder <80% não são automaticamente antiéticos quando bem justificados.[@Bacchetti2005]

-   Grandes estudos podem ser desejáveis por outras razões que não as éticas.[@Bacchetti2005]

<br>

## Saturação em pesquisas qualitativas

<br>

### O que é saturação de dados em pesquisas qualitativas?

-   Saturação é o ponto em que a coleta de dados não produz novas informações, categorias ou temas, indicando que o fenômeno investigado já foi suficientemente explorado.[@ahmed2025]

-   Essa noção surgiu na teoria fundamentada com o termo "saturação teórica", mas hoje é amplamente usada em diferentes tradições qualitativas, incluindo fenomenologia, etnografia e análise temática.[@hennink2022]

<br>

### Quais tipos de saturação existem?

-   Saturação de códigos: ocorre quando não emergem novos códigos relevantes nos dados[@hennink2022]

-   Saturação de significados: atinge-se quando a profundidade e a variação dos significados de um tema foram plenamente exploradas.[@hennink2022]

-   Saturação teórica: quando categorias estão suficientemente desenvolvidas e suas relações esclarecidas.[@ahmed2025]

-   Saturação de metatemas: em pesquisas multicêntricas, quando os grandes temas transversais já foram identificados.[@wutich2024]

<br>

```{r saturacao, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Curvas de poder para testes t (quantitativo). Linhas sólidas: α=0,05 | tracejadas: α=0,01 | linhas horizontais em 80% e 90% de poder.", out.width = "100%"}
# Reprodutibilidade
set.seed(123)

# Gera grade de cenários
grid_q <- expand.grid(
  n = seq(10, 200, by = 2),
  d = c(0.3, 0.5, 0.8),     # efeitos pequeno, médio, grande (Cohen)
  alpha = c(0.05, 0.01),
  design = c("t_indep", "t_dep") # 2 amostras indep. vs pareado (aprox com testes diferentes)
)

# Função segura para calcular poder com pwr
calc_power <- function(n, d, alpha, design){
  k <- 2
  if (design == "t_indep") {
    out <- pwr::pwr.t.test(n = n/ k * 1, d = d, sig.level = alpha, type = "two.sample", alternative = "two.sided")
    return(out$power)
  } else {
    # dependente (pareado) usa 1-amostra no d de diferenças (aprox. didática)
    out <- pwr::pwr.t.test(n = n, d = d, sig.level = alpha, type = "one.sample", alternative = "two.sided")
    return(out$power)
  }
}

grid_q$power <- mapply(calc_power, grid_q$n, grid_q$d, grid_q$alpha, grid_q$design)

# Plot principal
plt_power <- ggplot2::ggplot(grid_q, ggplot2::aes(x = n, y = power, linetype = factor(alpha), group = interaction(d, alpha, design))) +
  ggplot2::geom_hline(yintercept = 0.8, linewidth = 0.4, alpha = 0.6) +
  ggplot2::geom_hline(yintercept = 0.9, linewidth = 0.4, alpha = 0.6, linetype = "dashed") +
  ggplot2::geom_line(aes(size = factor(d), alpha = design)) +
  ggplot2::scale_y_continuous(labels = scales::percent_format(accuracy = 1), limits = c(0,1)) +
  ggplot2::scale_size_manual(values = c("0.3" = 0.4, "0.5" = 0.8, "0.8" = 1.2), name = "Efeito (d)") +
  ggplot2::scale_linetype_discrete(name = "α") +
  ggplot2::scale_alpha_discrete(name = "Desenho", labels = c(t_dep = "Pareado", t_indep = "2 amostras")) +
  ggplot2::labs(x = "Tamanho da amostra (n total)", y = "Poder estatístico",
       title = "Curvas de poder para testes t (quantitativo)",
       subtitle = "Linhas sólidas: α=0,05 | tracejadas: α=0,01 | linhas horizontais em 80% e 90% de poder") +
  ggplot2::theme_minimal(base_size = 12) +
  ggplot2::theme(legend.position = "bottom")

plt_power
```

<br>

```{r saturacao2, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Curvas de saturação para estudos qualitativos de descoberta de temas.", out.width = "100%"}
# Função que gera curva de saturação (descoberta cumulativa de "temas")
simulate_saturation <- function(n_interviews = 60, base_prob = 0.25, decay = 0.05, seed = 123){
  set.seed(seed)
  # prob de descobrir algo novo decai globalmente com mais coletas
  p_new <- pmax(base_prob * exp(-decay * (1:n_interviews)), 0.001)
  # número esperado de "descobertas" por entrevista (0/1) — ilustração
  new_theme <- rbinom(n_interviews, size = 1, prob = p_new)
  cum_themes <- cumsum(new_theme)
  data.frame(k = 1:n_interviews, new_theme, cum_themes, p_new)
}

# Dois cenários: homogêneo (satura rápido) vs heterogêneo (satura devagar)
sat_hom <- simulate_saturation(n_interviews = 60, base_prob = 0.35, decay = 0.09, seed = 42)
sat_het <- simulate_saturation(n_interviews = 60, base_prob = 0.30, decay = 0.04, seed = 99)

sat_hom$scenario <- "Homogêneo (temas recorrentes)"
sat_het$scenario <- "Heterogêneo (temas dispersos)"
sat <- dplyr::bind_rows(sat_hom, sat_het)

# Normaliza para "proporção do total de temas" (para visual comparável)
sat <- sat %>%
  dplyr::group_by(scenario) %>%
  dplyr::mutate(prop_sat = cum_themes / max(cum_themes)) %>%
  dplyr::ungroup()

plt_sat <- ggplot2::ggplot(sat, ggplot2::aes(x = k, y = prop_sat, color = scenario)) +
  ggplot2::geom_hline(yintercept = 0.9, linewidth = 0.4, linetype = "dashed", alpha = 0.7) +
  ggplot2::geom_line(linewidth = 1) +
  ggplot2::labs(x = "Número de entrevistas/grupos (k)",
       y = "Saturação acumulada (proporção de temas)",
       title = "Curvas de saturação (qualitativo)",
       subtitle = "Traço 0,90 indica um limiar ilustrativo de saturação temática") +
  ggplot2::theme_minimal(base_size = 12) +
  ggplot2::theme(legend.position = "bottom")

plt_sat
```

<br>

### Quantas entrevistas ou grupos focais são necessários para alcançar saturação?

-   Estudos empíricos mostram que a saturação de códigos pode ser atingida com 9 a 17 entrevistas em populações homogêneas e objetivos específicos.[@hennink2022]

-   Para saturação de significados, podem ser necessárias entre 16 e 24 entrevistas.[@hennink2022]

-   Em grupos focais, a saturação temática pode ocorrer com 4 a 8 grupos homogêneos.[@hennink2022]

-   Revisões recentes sugerem que a saturação teórica exige 20 a 30 entrevistas ou mais, dependendo da complexidade do estudo.[@wutich2024]

<br>

### Quais debates existem sobre o conceito de saturação?

-   Defensores argumentam que a saturação é central para garantir rigor e confiança nos resultados qualitativos.[@ahmed2025]

-   Críticos sugerem que o conceito pode ser usado de forma rígida, levando a coletas excessivas ou pouco sensíveis a perspectivas únicas.[@ahmed2025]

-   Pesquisadores contemporâneos recomendam usar a saturação de forma flexível, adaptada ao contexto, método e população estudada.[@wutich2024]

<br>

### Quais recomendações práticas para tamanho de amostras de estudos qualitativos?

-   Para entrevistas individuais: 9–12 entrevistas podem ser suficientes para saturação temática em contextos homogêneos, mas estudos heterogêneos ou multicêntricos exigem mais casos.[@hennink2022; @wutich2024]

-   Para grupos focais: 4–8 grupos são geralmente adequados.[@hennink2022]

-   Para estudos multicêntricos: recomenda-se 20–40 entrevistas por local para alcançar saturação de metatemas.[@wutich2024]

- É importante relatar não apenas o número de entrevistas, mas também como e quando a saturação foi avaliada.[@vasileiou2018]

<br>

## "Fome de dados"

<br>

### O que significa "fome de dados"?

- *Data hungry* descreve a necessidade de um modelo contar com muitos eventos por variável (EPV) para alcançar estabilidade estatística.

- Enquanto a regressão logística (LR) atinge desempenho estável com cerca de 20–50 EPV, modelos como random forest (RF), redes neurais (NN) e máquinas de vetor de suporte (SVM) podem demandar >200 EPV para reduzir o otimismo e estabilizar a AUC.

<br>

### Por que a "fome de dados" é relevante?

- Em bases de dados pequenas, modelos clássicos tendem a ser mais robustos e menos suscetíveis a superajuste.[@vanderploeg2014]

- O uso de modelos modernos só se justifica quando há grandes bases de dados, caso contrário o ganho em acurácia é marginal.[@vanderploeg2014]

- Esse conceito conecta diretamente a escolha do modelo ao planejamento amostral.[@vanderploeg2014]

<br>

## Eventos por variável (EPV) em modelos preditivos

<br>

### Quantos eventos por variável (EPV) são necessários?

- Regressão logística: entre 20 e 50 EPV.[@vanderploeg2014]

- Árvore de decisão para classificação e regressão: cerca de 60 EPV.[@vanderploeg2014]

- Máquina de vetores de suporte, redes neurais e *random forests*: muitas vezes >200 EPV e ainda instáveis.[@vanderploeg2014]

<br>

### O que acontece se não houver eventos suficientes?

- Modelos modernos podem apresentar alto otimismo (desempenho inflado no treino, mas ruim na validação).[@vanderploeg2014]

- Pequenos bancos de dados favorecem o uso de modelos clássicos.[@vanderploeg2014]

<br>

## Cálculo do tamanho da amostra

<br>

### Como calcular o tamanho da amostra?

-   O tamanho amostral pode ser calculado por meio de fórmulas matemáticas que tendem a assegurar margens de erros tipos I ($\alpha$) e II ($\beta$) para a estimação dos parâmetros populacionais (tamanho de efeito) a partir dos dados amostrais.[@rodríguezdeláguila2014]

-   O tamanho da amostra deve ser calculado para cada um dos objetivos primários e/ou secundários, sendo escolhido o maior tamanho de amostra calculado para o estudo.[@rodríguezdeláguila2014]

-   Geralmente é recomendado ser cético em relação às regras práticas para o tamanho da amostra, tais como a proporção entre o número de variáveis (ou eventos) e de participantes.[@van2022a]

<br>

### Como especificar o tamanho do efeito esperado?

-   Estudo-piloto --- realizados nas mesmas condições do estudo, mas envolvendo um tamanho de amostra limitado --- pode ser útil na estimativa do tamanho da amostra a partir do tamanho do efeito estimado.[@rodríguezdeláguila2014]

-   Utilizar os limites dos intervalos de confiança de estudos-piloto de ensaios clínicos como estimativa do tamanho do efeito pode aumentar o poder estatístico da análise se comparado ao uso das estimativas pontuais obtidas no mesmo piloto.[@ying2023]

-   Embora os testes de hipótese considerem efeito nulo para a hipótese nula --- ex.: diferença de média ($H_{0}: \mu_{1} - \mu_{2}=0$), correlação ($H_{0}: r=0$), associação ($H_{0}: \beta=0$ ou $H_{0}: OR=1$) ---, em geral é improvável que os efeitos populacionais sejam de fato nulos (isto é, exatamente 0).[@Andrade2020]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.2p.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.2p.test) para cálculo do tamanho da amostra para testes de proporção balanceados (2 amostras com mesmo número de participantes).
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.2p2n.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.2p.test) para cálculo do tamanho da amostra para testes de proporção não balanceados (2 amostras com diferente número de participantes).
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.anova.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.anova.test) para cálculo do tamanho da amostra para testes de análise de variância balanceados (3 ou mais amostras com mesmo número de participantes).
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.chisq.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.chisq.test) para cálculo do tamanho da amostra para testes de qui-quadrado $\chi^2$.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.f2.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.f2.test) para cálculo do tamanho da amostra para testes com modelo linear geral.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.norm.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.norm.test) para cálculo do tamanho da amostra para a média de uma distribuição normal com variância conhecida.
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.p.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.p.test) para cálculo do tamanho da amostra para testes de proporção (1 amostra).
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.r.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.r.test) para cálculo do tamanho da amostra para testes de correlação (1 amostra).
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.t.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.t.test) para cálculo do tamanho da amostra para testes *t* de diferença de 1 amostra, 2 amostras dependentes ou 2 amostras independentes (grupos balanceados).
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *pwr*[@pwr] fornece a função [*pwr.t2n.test*](https://www.rdocumentation.org/packages/pwr/versions/1.3-0/topics/pwr.t2n.test) para cálculo do tamanho da amostra para testes *t* de diferença de 2 amostras independentes (grupos não balanceados).
:::

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *longpower*[@longpower] fornece a função [*power.mmrm*](https://www.rdocumentation.org/packages/longpower/versions/1.0.24/topics/power.mmrm) para calcular o tamanho da amostra para estudos com análises por modelo de regressão linear misto.
:::

<br>


## Perdas de amostra

<br>

### O que é perda de amostra?

-   Perda de amostra(s) --- isto é, participante(s) ou unidade(s) de análise --- pode ocorrer durante a coleta e/ou acompanhamento dos participantes do estudo.[@rodríguezdeláguila2014]

-   Perda amostral pode ocorrer por: abandono ou desistência do participante, perda de contato com o participante, perda de informação, ocorrência de eventos adversos, morte do participante, entre outros.[@rodríguezdeláguila2014]

<br>

### Por que a perda de amostra é um problema?

-   A perda de amostra reduz o tamanho efetivo de $n$ e, portanto, o poder estatístico do estudo, elevando a probabilidade de erro tipo II ($\beta$).[@van2022a; @rodríguezdeláguila2014]

-   A atrição diferencial também pode introduzir viés de seleção (ou de atrito), quando as características dos participantes que permanecem diferem sistematicamente das daqueles que se perdem ao seguimento.[@rodríguezdeláguila2014]

<br>

### Como evitar perda de amostra?

-   A perda de amostra pode ser evitada por meio de um planejamento cuidadoso do estudo, incluindo a definição de critérios de inclusão e exclusão claros e apropriados, bem como a definição de estratégias para minimizar a perda de amostra.[@REF]

-   A perda de amostra pode ser compensada pelo aumento do tamanho da amostra, desde que o aumento seja suficiente para manter o poder do estudo.[@rodríguezdeláguila2014]

<br>

## Ajustes no tamanho da amostra

<br>

### Por que ajustar o tamanho da amostra?

-   O tamanho da amostra pode ser ajustado durante o estudo para compensar a perda de amostra, desde que o aumento seja suficiente para manter o poder do estudo.[@rodríguezdeláguila2014]

<br>

### Como ajustar para perda amostral?

-   Aumentar o tamanho da amostra estimada $n$ pela porcentagem $d$ de perdas esperada ou prevista, para obter o tamanho da amostra efetiva $n'$ \@ref(eq:samplesizeadj1):[@rodríguezdeláguila2014]

<br>

\begin{equation}
(\#eq:samplesizeadj1)
n' = \dfrac{n}{1-d}
\end{equation}

<br>

## Justificativa do tamanho da amostra

<br>

### Como justificar o tamanho da amostra de um estudo?

-   Em estudos que envolvem condições raras, pode ser difícil recrutar o número necessário de participantes devido à limitada disponibilidade de casos da população. Mesmo assim, é aconselhável determinar o tamanho da amostra.[@rodríguezdeláguila2014]

-   Quando um estudo deste tipo não é possível, as considerações referentes ao tamanho da amostra são justificadas de acordo com o número máximo de pacientes que podem ser recrutados no decorrer do estudo.[@rodríguezdeláguila2014]

<br>

### Como justificar o tamanho da amostra em estudos qualitativos?

-   Pesquisas qualitativas devem apresentar uma justificativa explícita da amostra, relacionando-a à estratégia de coleta, aos objetivos e ao critério de saturação adotado.[@vasileiou2018]

-   A noção de "poder da informação" (*information power*) indica que quanto mais relevante e focada é a amostra em relação à pergunta de pesquisa, menor pode ser o número de participantes.[@vasileiou2018]

-   Relatar claramente o processo de decisão aumenta a transparência e a credibilidade da pesquisa.[@vasileiou2018]

<br>

```{r, echo=FALSE, warning=FALSE, results='asis', eval=knitr::is_html_output()}
cat(readLines("citation.html"), sep = "\n")
```

<br>
