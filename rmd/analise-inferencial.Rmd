```{=openxml}
<w:p>
  <w:r>
    <w:br w:type="page"/>
  </w:r>
</w:p>
```

# **An√°lise inferencial** {#analise-inferencial}

<br>

## Racioc√≠nio inferencial

<br>

### O que √© an√°lise inferencial?

-   Na an√°lise inferencial s√£o utilizados dados da(s) amostra(s) para fazer uma infer√™ncia v√°lida (isto √©, estimativa) sobre os par√¢metros populacionais desconhecidos.[@vetter2017]

-   No paradigma de Jerzy Neyman e Egon Pearson, um teste de hip√≥tese cient√≠fica envolve a tomada de decis√£o sobre hip√≥teses nulas ($H_{0}$) e alternativa ($H_{1}$) concorrentes e mutuamente exclusivas.[@Curran-Everett2009]

<br>

### Quais s√£o os tipos de racioc√≠nio inferencial?

-   Infer√™ncia dedutiva: Uma dada hip√≥tese inicial √© utilizada para prever o que seria observado caso tal hip√≥tese fosse verdadeira.[@goodman1999]

-   Infer√™ncia indutiva: Com base nos dados observados, avalia-se qual hip√≥tese √© mais defens√°vel (isto √©, mais prov√°vel).[@goodman1999]

<br>

### Quais s√£o as quest√µes fundamentais da an√°lise inferencial?

-   A dire√ß√£o do efeito[@mccaskey2015]

-   A magnitude do efeito[@mccaskey2015]

-   A import√¢ncia do efeito[@mccaskey2015]

<br>

## Hip√≥teses cient√≠ficas

<br>

### O que √© hip√≥tese cient√≠fica?

-   Hip√≥tese cient√≠fica √© uma ideia que pode ser testada.[@Curran-Everett2009]

-   Definir claramente os problemas e os objetivos da pesquisa s√£o o ponto de partida de todos os estudos cient√≠ficos.[@van2022a]

-   Al√©m do papel t√©cnico, os testes de hip√≥tese carregam uma dimens√£o interpretativa que molda como os pesquisadores comunicam descobertas. Estudos recentes destacam o car√°ter pragm√°tico e dicot√¥mico dessas decis√µes.[@uyguntun√ß2023]

<br>

### Quais s√£o as fontes de ideias para gerar hip√≥teses cient√≠ficas?

-   Revis√£o das pr√°ticas atuais.[@Vandenbroucke2018]

-   Desafio a ideias aceitas.[@Vandenbroucke2018]

-   Conflito entre ideias divergentes.[@Vandenbroucke2018]

-   Varia√ß√µes regionais, temporais e populacionais.[@Vandenbroucke2018]

-   Experi√™ncias dos pr√≥prios pesquisadores.[@Vandenbroucke2018]

-   Imagina√ß√£o sem fronteiras ou limites convencionais.[@Vandenbroucke2018]

<br>

## Hip√≥teses estat√≠sticas

<br>

### O que √© hip√≥tese nula?

-   A hip√≥tese nula ($H_{0}$) √© uma express√£o que representa o estado atual do conhecimento (*status quo*), em geral a n√£o exist√™ncia de um determinado efeito.[@kanji2006]

<br>

### O que √© hip√≥tese alternativa?

-   A hip√≥tese alternativa ($H_{1}$) √© uma express√£o que cont√©m as situa√ß√µes que ser√£o testadas, de modo que um resultado positivo indique alguma a√ß√£o a ser conduzida.[@kanji2006]

<br>

### Qual hip√≥tese est√° sendo testada?

-   A hip√≥tese nula ($H_{0}$) √© a hip√≥tese sob teste em an√°lises inferenciais.[@Ali2016]

-   Pode-se concluir sobre rejeitar ou n√£o rejeitar a hip√≥tese nula ($H_{0}$).[@Ali2016]

-   N√£o se conclui sobre a hip√≥tese alternativa ($H_{1}$).[@kanji2006]

-   Para testar a hip√≥tese nula, deve-se selecionar o n√≠vel de signific√¢ncia cr√≠tica (P-valor de corte); a probabilidade de rejeitarmos uma hip√≥tese nula verdadeira ($\alpha$); e a probabilidade de n√£o rejeitarmos uma hip√≥tese nula falsa ($\beta$).[@Curran-Everett2009]

<br>

## Testes de hip√≥teses

<br>

### Quais s√£o os tipos de teste de hip√≥teses?

-   Teste (cl√°ssico) de signific√¢ncia da hip√≥tese nula: verifica evid√™ncia contra $H_{0}$ usando P-valor.[@lakens2018]

-   Teste de m√≠nimos efeitos (MOTE/MOST/SESOI): testa se o efeito √© pelo menos t√£o grande quanto um limiar de relev√¢ncia (SESOI). Rejeitar $H_{0}$ sugere efeito grande o suficiente.[@lakens2018]

-   Teste de equival√™ncia (TOST): testa se o efeito est√° dentro de uma margem de equival√™ncia clinicamente irrelevante (entre $\Delta$ e $-\Delta$). Rejeitar $H_{0}$ sugere equival√™ncia pr√°tica.[@lakens2018]

-   Teste de superioridade: avalia se um tratamento/interven√ß√£o supera o controle por uma margem $>0$ ou $>\Delta$.[@lakens2018]

-   Teste de n√£o-inferioridade: avalia se o tratamento n√£o √© pior que o controle por mais do que $-\Delta$.[@REF]

-   Teste de inferioridade: avalia se o tratamento √© pior que o controle (por exemplo, para checar seguran√ßa).[@REF]

<br>

### O que reportar ap√≥s um teste de hip√≥tese?

-   P-valores, como estimativa da signific√¢ncia estat√≠stica.[@Sullivan2012]

-   Tamanho do efeito, como estimativa de signific√¢ncia substantiva.[@Sullivan2012]

<br>

## Intervalos de confian√ßa e racioc√≠nio de longo prazo

<br>

### O que √© um intervalo de confian√ßa?

-   Um intervalo de confian√ßa √© um procedimento inferencial utilizado para estimar um par√¢metro populacional desconhecido a partir de dados amostrais, levando em conta a variabilidade inerente ao processo de amostragem.[@neyman1937]

-   Diferentemente de uma estat√≠stica descritiva, o intervalo de confian√ßa n√£o √© uma propriedade fixa do par√¢metro, mas uma propriedade do procedimento estat√≠stico utilizado para estim√°-lo.[@goodman2016]

-   O par√¢metro populacional √© considerado fixo (embora desconhecido), enquanto o intervalo de confian√ßa √© uma quantidade aleat√≥ria, pois depende da amostra observada.[@REF]

<br>

### Intervalos de confian√ßa e a l√≥gica frequentista

-   No paradigma frequentista, a probabilidade √© interpretada como uma frequ√™ncia relativa observ√°vel no longo prazo, associada a um processo repet√≠vel.[@neyman1937]

-   Um intervalo de confian√ßa de n√≠vel $(1-\alpha)$ √© constru√≠do de modo que, se o mesmo procedimento de amostragem e an√°lise fosse repetido indefinidamente sob as mesmas condi√ß√µes, aproximadamente $(1-\alpha)\times100\%$ dos intervalos assim gerados conteriam o verdadeiro valor do par√¢metro populacional.[@goodman2016]

-   Portanto, a probabilidade associada ao intervalo de confian√ßa refere-se ao desempenho do procedimento no longo prazo, e n√£o √† probabilidade de o par√¢metro estar contido em um intervalo espec√≠fico observado.

<br>

```{r intervalo-confianca-long-run, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Simula√ß√£o ilustrativa de intervalos de confian√ßa (IC) em 100 experimentos independentes, cada um com 1.000 observa√ß√µes amostradas de uma popula√ß√£o normal padr√£o (m√©dia = 0, desvio-padr√£o = 1). Os ICs s√£o constru√≠dos no n√≠vel de 95\\%. O gr√°fico superior mostra os ICs individuais para cada experimento, indicando se o IC cobre ou n√£o a m√©dia verdadeira ($\\mu = 0$). O gr√°fico inferior apresenta a distribui√ß√£o das m√©dias amostrais obtidas nos experimentos, juntamente com o IC te√≥rico para a m√©dia populacional. Observe que aproximadamente 95\\% dos ICs individuais cobrem a m√©dia verdadeira, ilustrando o conceito de cobertura no longo prazo associado aos intervalos de confian√ßa."}
# reprodutibilidade
set.seed(123)

# Par√¢metros do mundo real
mu_true <- 0
sigma  <- 1
n      <- 1000
alpha  <- 0.05

# N√∫mero de experimentos
n_exp <- 100

# Simula√ß√£o
sim_results <- lapply(1:n_exp, function(i) {
  x <- rnorm(n, mean = mu_true, sd = sigma)
  xbar <- mean(x)
  se   <- sd(x) / sqrt(n)
  z    <- qnorm(1 - alpha / 2)
  tibble::tibble(
    experimento = i,
    M√©dia = xbar,
    ic_inf = xbar - z * se,
    ic_sup = xbar + z * se,
    cobre_mu = (xbar - z * se <= mu_true) &
               (xbar + z * se >= mu_true)
  )
})

df <- dplyr::bind_rows(sim_results)
x_limits <- range(c(df$ic_inf, df$ic_sup))
z <- qnorm(1 - alpha / 2)
se_mean <- sigma / sqrt(n)
ic_mu_inf <- mu_true - z * se_mean
ic_mu_sup <- mu_true + z * se_mean
df_ic <- data.frame(
  x = c(ic_mu_inf, ic_mu_sup),
  tipo = "IC 95%"
)

# Gr√°fico 1: Intervalos de Confian√ßa
p_ic <- ggplot2::ggplot(df, ggplot2::aes(y = experimento, x = M√©dia)) +
  ggplot2::geom_errorbarh(
    ggplot2::aes(xmin = ic_inf, xmax = ic_sup, color = cobre_mu),
    width = 0.3,
    linewidth = 0.5
  ) +
  ggplot2::geom_point(ggplot2::aes(color = cobre_mu), size = 2) +
  ggplot2::geom_vline(
    xintercept = mu_true,
    linetype = "dashed",
    linewidth = 0.5
  ) +
  ggplot2::scale_color_manual(
    values = c("TRUE" = "blue", "FALSE" = "red"),
    labels = c("TRUE" = "IC cobre Œº", "FALSE" = "IC n√£o cobre Œº"),
    name = NULL
  ) +
  ggplot2::labs(
    x = "Estimativa da m√©dia",
    y = "Experimento",
    title = "Intervalos de Confian√ßa (95%) em Experimentos Independentes"
  ) +
  ggplot2::coord_cartesian(xlim = x_limits) +
  ggplot2::theme_minimal(base_size = 13) +
  ggplot2::theme(
    axis.text.x = ggplot2::element_blank(),
    legend.position = "right"
  ) +
  ggplot2::theme(
    panel.grid = ggplot2::element_blank(),
    axis.line  = ggplot2::element_line(
      linewidth = 0.6,
      colour = "black"
    )
  )

# Gr√°fico 2: Distribui√ß√£o das m√©dias amostrais
p_dist <- ggplot2::ggplot(df, ggplot2::aes(x = M√©dia)) +
  ggplot2::geom_density(
    ggplot2::aes(fill = "M√©dias amostrais"),
    alpha = 0.6,
    linewidth = 1
  ) +
  ggplot2::geom_vline(
    ggplot2::aes(xintercept = mu_true,
                 linetype = "M√©dia verdadeira (Œº)"),
    linewidth = 1
  ) +
  ggplot2::geom_vline(
    data = df_ic,
    ggplot2::aes(xintercept = x,
                 linetype = tipo),
    linewidth = 0.8
  ) +
  ggplot2::scale_fill_manual(
    name = NULL,
    values = c("M√©dias amostrais" = "grey70")
  ) +
  ggplot2::scale_linetype_manual(
    name = NULL,
    values = c(
      "M√©dia verdadeira (Œº)" = "dashed",
      "IC 95%"               = "dotted"
    )
  ) +
  ggplot2::labs(
    y = "Densidade",
    title = "Distribui√ß√£o das M√©dias Amostrais"
  ) +
  ggplot2::coord_cartesian(xlim = x_limits) +
  ggplot2::theme_minimal(base_size = 13) +
  ggplot2::theme(
    panel.grid = ggplot2::element_blank(),
    axis.line  = ggplot2::element_line(
      linewidth = 0.6,
      colour = "black"
    )
  )

# Combina√ß√£o dos gr√°ficos
library(patchwork)
p_ic / p_dist+
  patchwork::plot_layout(heights = c(5, 1))
```

<br>

### O que um intervalo de confian√ßa n√£o representa

-   Um intervalo de confian√ßa n√£o deve ser interpretado como a probabilidade de que o par√¢metro esteja contido naquele intervalo espec√≠fico.[@greenland2016]

-   Ap√≥s os dados terem sido observados e o intervalo calculado, o par√¢metro populacional ou est√° dentro do intervalo ou n√£o est√°; n√£o h√° incerteza probabil√≠stica sobre isso no sentido frequentista.[@greenland2016]

-   A incerteza expressa pelo intervalo de confian√ßa refere-se √† variabilidade do processo inferencial, e n√£o a uma distribui√ß√£o de probabilidade do par√¢metro.[@greenland2016]

<br>

### Rela√ß√£o entre intervalos de confian√ßa e testes de hip√≥teses

-   Intervalos de confian√ßa e testes de hip√≥tese frequentistas s√£o derivados do mesmo modelo probabil√≠stico subjacente e utilizam as mesmas suposi√ß√µes estat√≠sticas.[@cumming2005]

-   Em testes bicaudais, qualquer valor hipot√©tico do par√¢metro que esteja fora do intervalo de confian√ßa de n√≠vel $(1-\alpha)$ corresponde a uma hip√≥tese nula que seria rejeitada ao n√≠vel de signific√¢ncia $\alpha$.[@cumming2005]

-   De forma an√°loga, valores do par√¢metro que estejam dentro do intervalo de confian√ßa correspondem a hip√≥teses nulas para as quais n√£o haveria evid√™ncia suficiente para rejei√ß√£o ao n√≠vel $\alpha$.[@cumming2005]

-   Apesar dessa equival√™ncia formal, intervalos de confian√ßa e testes de hip√≥tese respondem a perguntas distintas: testes enfatizam decis√µes dicot√¥micas, enquanto intervalos de confian√ßa enfatizam estima√ß√£o e incerteza.[@cumming2005]

<br>

### Por que intervalos de confian√ßa s√£o centrais na infer√™ncia cient√≠fica

-   Intervalos de confian√ßa permitem avaliar simultaneamente a magnitude do efeito e a incerteza associada √† sua estimativa, na mesma unidade de medida da vari√°vel de interesse.[@cumming2005]

-   Essa abordagem favorece interpreta√ß√µes substantivas e cient√≠ficas dos resultados, em oposi√ß√£o a decis√µes puramente dicot√¥micas baseadas em pontos de corte arbitr√°rios.[@cumming2005]

-   Quando corretamente interpretados, intervalos de confian√ßa promovem uma comunica√ß√£o mais informativa da evid√™ncia cient√≠fica e reduzem interpreta√ß√µes equivocadas associadas ao uso exclusivo de P-valores.[@greenland2016]

<br>

## Compara√ß√µes m√∫ltiplas

<br>

### O que √© uma fam√≠lia de hip√≥teses?

-   Fam√≠lia de hip√≥teses √© um conjunto de compara√ß√µes/infer√™ncias que, por desenho ou an√°lise, devem ser consideradas juntas para controle do erro tipo I global (ex.: todas as compara√ß√µes de um desfecho prim√°rio, todos os subgrupos pr√©-especificados, todos os desfechos coprim√°rios).[@REF]

-   O controle do *family-wise error rate* (FWER) ou do *false discovery rate* (FDR) deve considerar a fam√≠lia pertinente, n√£o compara√ß√µes isoladas.[@REF]

<br>

### O que s√£o testes *ad hoc* e *post hoc*?

-   *Ad hoc*: an√°lises/decis√µes n√£o planejadas a priori, motivadas por inspe√ß√£o dos dados. √öteis para gerar hip√≥teses, n√£o para confirm√°-las.[@REF]

-   *Post hoc*: procedimentos de compara√ß√µes m√∫ltiplas aplicados ap√≥s um teste global ter indicado efeito significativo. Visam controlar o erro tipo I em m√∫ltiplas compara√ß√µes.[@REF]

<br>

### Como ajustar a an√°lise inferencial para hip√≥teses m√∫ltiplas?

-   Defina a fam√≠lia (o que entra no ajuste) e priorize desfechos (prim√°rio, coprim√°rios, secund√°rios).[@REF]

-   Aplique m√©todos de controle FWER (Bonferroni, Holm, Hochberg, Dunnett para m√∫ltiplos vs. controle) ou controle FDR (Benjamini‚ÄìHochberg) conforme o objetivo (confirma√ß√£o vs. explora√ß√£o).[@REF]

-   Em planos confirmat√≥rios, use hierarquiza√ß√£o/gatekeeping: testa-se em sequ√™ncia; a aloca√ß√£o de $\alpha$ passa adiante apenas se houver signific√¢ncia no n√≠vel anterior.[@REF]

<br>

::: {.infobox .Rlogo data-latex="{images/Rlogo}"}
O pacote *stats*[@stats] fornece a fun√ß√£o [*p.adjust*](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/p.adjust) para ajustar o P-valor utilizando diversos m√©todos.
:::

<br>

### O que s√£o testes unicaudais e bicaudais?

-   Teste unicaudal procura evid√™ncia em uma dire√ß√£o espec√≠fica (ex.: ‚Äúmaior que 0‚Äù). Toda a regi√£o cr√≠tica est√° numa s√≥ cauda; tem maior poder para aquela dire√ß√£o, mas n√£o detecta sinal oposto.[@REF]

<br>

```{r unicaudal-direita, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Representa√ß√£o gr√°fica de um teste de hip√≥tese unicaudal √† direita, aplicado quando se busca evid√™ncia de efeitos positivos (valores significativamente maiores que o esperado sob $H_0$)."}
# Par√¢metros
mu0 <- 0
sigma <- 1
alpha <- 0.05

# Valor cr√≠tico (cauda direita)
z_crit <- qnorm(1 - alpha, mean = mu0, sd = sigma)

# Dados
x <- seq(mu0 - 4 * sigma, mu0 + 4 * sigma, length.out = 1000)
dens_H0 <- dnorm(x, mean = mu0, sd = sigma)
dados <- data.frame(x = x, densidade = dens_H0)
dados$regiao_critica <- ifelse(x >= z_crit, "regiao_critica", "h0")

# Gr√°fico
ggplot2::ggplot(dados, ggplot2::aes(x = x, y = densidade)) +
  ggplot2::geom_line(ggplot2::aes(color = "h0"), size = 1.2) +
  ggplot2::geom_area(
    data = subset(dados, regiao_critica == "regiao_critica"),
    ggplot2::aes(fill = "regiao_critica"),
    alpha = 0.3
  ) +
  ggplot2::geom_vline(
    xintercept = mu0,
    linetype = "dotted",
    color = "blue",
    size = 1
  ) +
  ggplot2::geom_vline(
    ggplot2::aes(xintercept = z_crit, linetype = "zcrit"),
    color = "black",
    size = 1
  ) +
  ggplot2::annotate(
    "text",
    x = mu0 + 0.1,
    y = max(dens_H0) * 0.85,
    label = "mu[0]",     # üîß string + parse=TRUE
    color = "blue",
    parse = TRUE,
    hjust = 0
  ) +
  ggplot2::annotate(
    "text",
    x = z_crit + 0.1,
    y = max(dens_H0) * 0.95,
    label = "z[1 - alpha]",  # üîß string + parse=TRUE
    color = "black",
    parse = TRUE,
    hjust = 0
  ) +
  ggplot2::scale_color_manual(
    name = NULL,
    values = c("h0" = "blue"),
    labels = c(expression("Distribui√ß√£o H"[0]))
  ) +
  ggplot2::scale_linetype_manual(
    name = NULL,
    values = c("zcrit" = "dashed"),
    labels = c(expression("Valor cr√≠tico (z"[1 - alpha] * ")"))
  ) +
  ggplot2::scale_fill_manual(
    name = NULL,
    values = c("regiao_critica" = "blue"),
    labels = c("Regi√£o cr√≠tica (Œ±)")
  ) +
  ggplot2::labs(
    title = "Teste Unicaudal (cauda direita) da Hip√≥tese Nula",
    x = "Efeito",
    y = "Densidade"
  ) +
  ggplot2::theme_minimal(base_size = 14) +
  ggplot2::theme(
    legend.position = "bottom",
    legend.text = ggplot2::element_text(size = 12)
  ) +
  ggplot2::guides(
    color = ggplot2::guide_legend(order = 1, override.aes = list(linetype = "solid")),
    linetype = ggplot2::guide_legend(order = 2, override.aes = list(color = "black", size = 1)),
    fill = ggplot2::guide_legend(order = 3, override.aes = list(alpha = 0.3))
  )
```

<br>

```{r unicaudal-esquerda, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Representa√ß√£o gr√°fica de um teste de hip√≥tese unicaudal √† esquerda, aplicado quando se busca evid√™ncia de efeitos negativos (valores significativamente menores que o esperado sob $H_0$)."}
# Par√¢metros
mu0 <- 0
sigma <- 1
alpha <- 0.05

# Valor cr√≠tico (cauda esquerda)
z_crit <- qnorm(alpha, mean = mu0, sd = sigma)

# Dados
x <- seq(mu0 - 4 * sigma, mu0 + 4 * sigma, length.out = 1000)
dens_H0 <- dnorm(x, mean = mu0, sd = sigma)
dados <- data.frame(x = x, densidade = dens_H0)
dados$regiao_critica <- ifelse(x <= z_crit, "regiao_critica", "h0")

# Gr√°fico
ggplot2::ggplot(dados, ggplot2::aes(x = x, y = densidade)) +
  ggplot2::geom_line(ggplot2::aes(color = "h0"), size = 1.2) +
  ggplot2::geom_area(
    data = subset(dados, regiao_critica == "regiao_critica"),
    ggplot2::aes(fill = "regiao_critica"),
    alpha = 0.3
  ) +
  ggplot2::geom_vline(
    xintercept = mu0,
    linetype = "dotted",
    color = "blue",
    size = 1
  ) +
  ggplot2::geom_vline(
    ggplot2::aes(xintercept = z_crit, linetype = "zcrit"),
    color = "black",
    size = 1
  ) +
  ggplot2::annotate(
    "text",
    x = mu0 + 0.1,
    y = max(dens_H0) * 0.85,
    label = "mu[0]",        # <-- string + parse=TRUE
    color = "blue",
    parse = TRUE,
    hjust = 0
  ) +
  ggplot2::annotate(
    "text",
    x = z_crit - 0.1,       # melhor na esquerda do corte
    y = max(dens_H0) * 0.95,
    label = "z[alpha]",     # <-- string + parse=TRUE
    color = "black",
    parse = TRUE,
    hjust = 1
  ) +
  ggplot2::scale_color_manual(
    name = NULL,
    values = c("h0" = "blue"),
    labels = c(expression("Distribui√ß√£o H"[0]))
  ) +
  ggplot2::scale_linetype_manual(
    name = NULL,
    values = c("zcrit" = "dashed"),
    labels = c(expression("Valor cr√≠tico (z"[alpha] * ")"))
  ) +
  ggplot2::scale_fill_manual(
    name = NULL,
    values = c("regiao_critica" = "blue"),
    labels = c("Regi√£o cr√≠tica (Œ±)")
  ) +
  ggplot2::labs(
    title = "Teste Unicaudal (cauda esquerda) da Hip√≥tese Nula",
    x = "Efeito",
    y = "Densidade"
  ) +
  ggplot2::theme_minimal(base_size = 14) +
  ggplot2::theme(
    legend.position = "bottom",
    legend.text = ggplot2::element_text(size = 12)
  ) +
  ggplot2::guides(
    color = ggplot2::guide_legend(order = 1, override.aes = list(linetype = "solid")),
    linetype = ggplot2::guide_legend(order = 2, override.aes = list(color = "black", size = 1)),
    fill = ggplot2::guide_legend(order = 3, override.aes = list(alpha = 0.3))
  )
```

<br>

-   Teste bicaudal procura evid√™ncia em qualquer dire√ß√£o (ex.: ‚Äúdiferente de 0‚Äù). Divide $\alpha$ em duas caudas (direita e esquerda). √â a escolha padr√£o quando ambas as dire√ß√µes s√£o plaus√≠veis.[@REF]

<br>

```{r bicaudal, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Representa√ß√£o gr√°fica de um teste de hip√≥tese bicaudal, aplicado quando se busca evid√™ncia de efeitos positivos ou negativos (valores significativamente diferentes do esperado sob $H_0$)."}
# Par√¢metros
mu0 <- 0
sigma <- 1
alpha <- 0.05

# Valores cr√≠ticos (duas caudas)
z_lower <- qnorm(alpha / 2, mean = mu0, sd = sigma)
z_upper <- qnorm(1 - alpha / 2, mean = mu0, sd = sigma)

# Dados
x <- seq(mu0 - 4 * sigma, mu0 + 4 * sigma, length.out = 1000)
dens_H0 <- dnorm(x, mean = mu0, sd = sigma)
dados <- data.frame(x = x, densidade = dens_H0)

# Caudas separadas
dados_cauda_inf <- subset(dados, x <= z_lower)
dados_cauda_sup <- subset(dados, x >= z_upper)

# Gr√°fico
ggplot2::ggplot(dados, ggplot2::aes(x = x, y = densidade)) +
  
  # Linha da distribui√ß√£o H0 com legenda
  ggplot2::geom_line(ggplot2::aes(color = "H0"), size = 1.2) +
  
  # √Årea das caudas com legenda
  ggplot2::geom_area(data = dados_cauda_inf,
                     ggplot2::aes(x = x, y = densidade, fill = "rc"),
                     alpha = 0.3) +
  ggplot2::geom_area(data = dados_cauda_sup,
                     ggplot2::aes(x = x, y = densidade, fill = "rc"),
                     alpha = 0.3) +
  
  # Linha pontilhada em mu0
  ggplot2::geom_vline(
    xintercept = mu0,
    linetype = "dotted",
    color = "blue",
    size = 1
  ) +
  
  # Linhas dos valores cr√≠ticos com legenda
  ggplot2::geom_vline(
    ggplot2::aes(xintercept = z_lower, linetype = "zcrit"),
    color = "black",
    size = 1
  ) +
  ggplot2::geom_vline(
    ggplot2::aes(xintercept = z_upper, linetype = "zcrit"),
    color = "black",
    size = 1
  ) +
  
# Anota√ß√µes (use strings + parse=TRUE)
ggplot2::annotate(
  "text",
  x = mu0 + 0.1,
  y = max(dens_H0) * 0.85,
  label = "mu[0]",   # era expression(mu[0])
  color = "blue",
  parse = TRUE,
  hjust = 0
) +
ggplot2::annotate(
  "text",
  x = z_upper + 0.1,
  y = max(dens_H0) * 0.95,
  label = "z[1 - alpha/2]",   # era expression(z[1 - alpha / 2])
  color = "black",
  parse = TRUE,
  hjust = 0
) +
ggplot2::annotate(
  "text",
  x = z_lower - 0.1,
  y = max(dens_H0) * 0.95,
  label = "z[alpha/2]",   # era expression(z[alpha / 2])
  color = "black",
  parse = TRUE,
  hjust = 1
) +
  # Legendas
  ggplot2::scale_color_manual(
    name = NULL,
    values = c("H0" = "blue"),
    labels = c("Distribui√ß√£o H0")
  ) +
  ggplot2::scale_fill_manual(
    name = NULL,
    values = c("rc" = "blue"),
    labels = c("Regi√µes cr√≠ticas (Œ±)")
  ) +
  ggplot2::scale_linetype_manual(
    name = NULL,
    values = c("zcrit" = "dashed"),
    labels = c("Valores cr√≠ticos (zŒ±/2, z1‚àíŒ±/2)")
  ) +
  ggplot2::labs(title = "Teste Bicaudal da Hip√≥tese Nula", x = "Efeito", y = "Densidade") +
  ggplot2::theme_minimal(base_size = 14) +
  ggplot2::theme(legend.position = "bottom",
                 legend.text = ggplot2::element_text(size = 12)) +
  ggplot2::guides(
    color = ggplot2::guide_legend(order = 1, override.aes = list(linetype = "solid")),
    linetype = ggplot2::guide_legend(
      order = 2,
      override.aes = list(color = "black", size = 1)
    ),
    fill = ggplot2::guide_legend(order = 3, override.aes = list(alpha = 0.3))
  )
```

<br>

## Infer√™ncia visual

<br>

### O que √© infer√™ncia visual?

-   Infer√™ncia visual consiste na interpreta√ß√£o de dados apresentados em gr√°ficos.[@cumming2005]

-   Para infer√™ncia visual, recomenda-se a apresenta√ß√£o dos dados em gr√°ficos com estimativas de tend√™ncia central e seu intervalo (preferencialmete intervalo de confian√ßa no n√≠vel de signific√¢ncia $\alpha$ pr√©-estabelecido).[@cumming2005]

<br>

### Por que usar intervalos de confian√ßa para infer√™ncia visual?

-   Intervalos de confian√ßa fornecem estimativas pontuais e intervalares na mesma unidade de medida da vari√°vel.[@cumming2005]

-   Existe uma rela√ß√£o entre o intervalo de confian√ßa e o P-valor obtido pelo teste de signific√¢ncia de hip√≥tese nula $H_{0}$, em que ambos consideram o mesmo n√≠vel de signific√¢ncia $\alpha$ pr√©-estabelecido.[@cumming2005]

<br>

### Como interpretar intervalos de confian√ßa em uma figura?

-   Identifique o que as tend√™ncias centrais e as barras de erro representam. Qual √© a vari√°vel dependente? √â expressa em unidades originais ou √© padronizada ? A figura mostra intervalos de confian√ßa, erro-padr√£o ou desvio-padr√£o? Qual √© o desenho experimental?[@cumming2005]

-   Fa√ßa uma interpreta√ß√£o substantiva dos valores de tend√™ncia central e dos intervalos de confian√ßa.[@cumming2005]

-   O intervalo de confian√ßa √© uma faixa de valores plaus√≠veis para a tend√™ncia central. Valores fora do intervalo s√£o relativamente implaus√≠veis, no n√≠vel de signific√¢ncia $\alpha$ pr√©-estabelecido.[@cumming2005]

-   Qualquer valor fora do intervalo de confian√ßa, quando considerado como hip√≥tese nula ($H_{0}$), equivale a $P < \alpha$ pr√©-estabelecido (bicaudal).[@cumming2005]

-   Qualquer valor dentro do intervalo, quando considerado como hip√≥tese nula ($H_{0}$), equivale a $P > \alpha$ pr√©-estabelecido (bicaudal).[@cumming2005]

<br>

## Interpreta√ß√£o de an√°lise inferencial

<br>

### Como interpretar uma an√°lise inferencial?

-   Testes de hip√≥tese nula ($H_{0}$) vs. alternativa ($H_{1}$) a partir de um n√≠vel de signific√¢ncia ($\alpha$) pr√©-especificado.[@goodman2016]

-   P-valor como evid√™ncia estat√≠stica sobre ($H_{0}$).[@goodman2016]

-   Estima√ß√£o de intervalos de confian√ßa de um n√≠vel de signific√¢ncia ($\alpha$) pr√©-especificado bicaudal ($IC_{1-\alpha/2}$) ou unicaudal ($IC_{1-\alpha}$).[@goodman2016]

-   An√°lise Bayesiana.[@goodman2016]

<br>

### O que s√£o resultados positivos" e "negativos" (inconclusivos) em teste de hip√≥tese?

-   Resultados "positivos" compreendem um P-valor dentro da zona cr√≠tica estatisticamente significativa (ex.: $P<0,05$ ou outro ponto de corte) e sugerem que os autores rejeitem a hip√≥tese nula ($H_{0}$), confirmando assim sua hip√≥tese cient√≠fica.[@greenhalgh1997a]

-   Resultados "negativos" ou inconclusivos compreendem um P-valor fora da zona cr√≠tica estatisticamente significativa (ex.: $P \geq 0,05$ ou outro ponto de corte) e sugerem que os autores n√£o rejeitem a hip√≥tese nula ($H_{0}$) porque o efeito observado √© nulo (logo, "negativo"), ou porque o estudo n√£o possui poder suficiente para detect√°-lo, n√£o permitindo portanto afirmar a hip√≥tese cient√≠fica (logo, inconclusivo).[@greenhalgh1997a]

<br>

### Qual a import√¢ncia de resultados "negativos"?

-   Conhecer resultados negativos contribui com uma vis√£o mais ampla do campo de estudo junto aos resultados positivos.[@weintraub2016]

-   Resultados negativos permitem um melhor planejamento das pesquisas futuras e pode aumentar suas chances de sucesso.[@weintraub2016]

<br>

### Resultados inconclusivos: Aus√™ncia de evid√™ncia ou evid√™ncia de aus√™ncia?

-   Em estudos (geralmente com amostras grandes), resultados estatisticamente significativos (com P-valores menores do limiar pr√©-estabelecido, $P<\alpha$) podem n√£o ser clinicamente relevantes.[@altman1995]

-   Em estudos (geralmente com amostras pequenas), resultados estatisticamente n√£o significativos (com P-valores iguais ou maiores do limiar pr√©-estabelecido, $P \geq \alpha$) n√£o devem ser interpretados como evid√™ncia de inexist√™ncia do efeito.[@altman1995]

-   Geralmente √© razo√°vel aceitar uma nova conclus√£o apenas quando h√° dados a seu favor ('resultados positivos'). Tamb√©m √© razo√°vel questionar se apenas a aus√™ncia de dados a seu favor ('resultados negativos') justifica suficientemente a rejei√ß√£o de tal conclus√£o.[@altman1995]

-   A pr√°tica estat√≠stica convencional tende a reduzir a incerteza cient√≠fica a decis√µes docot√¥micas. Essa simplifica√ß√£o possui implica√ß√µes epistemol√≥gicas importantes: os testes de hip√≥tese produzem n√£o apenas ju√≠zos emp√≠ricos, mas tamb√©m atos pragm√°ticos que comunicam graus de confian√ßa e orientam a√ß√µes.[@uyguntun√ß2023]

<br>

## Erros de infer√™ncia I, II, S e M

<br>

### O que s√£o erros de infer√™ncia estat√≠stica?

-   Um erro de infer√™ncia √© a tomada de decis√£o incorreta, seja a favor ou contra a hip√≥tese nula ($H_{0}$).[@Curran-Everett2009]

<br>

### O que s√£o erros Tipo I e Tipo II?

-   Erro Tipo I significa a rejei√ß√£o de uma hip√≥tese nula ($H_{0}$) quando esta √© verdadeira.[@Curran-Everett2009]

-   Erro Tipo II significa a n√£o rejei√ß√£o de uma hip√≥tese nula ($H_{0}$) quando esta √© falsa.[@Curran-Everett2009]

<br>

```{r tabela-erros-I-II, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, tab.cap = "Tabela de erros tipos I e II de infer√™ncia estat√≠stica."}
# Cria uma tabela de erros tipo I e II
cross.table.erros <-
  matrix(
    c(
      'Decis√£o correta',
      'Decis√£o incorreta (erro tipo II)',
      'Decis√£o incorreta (erro tipo I)',
      'Decis√£o correta'
    ),
    nrow = 2,
    ncol = 2,
    byrow = FALSE
  )
rownames(cross.table.erros) <-
  c("Hip√≥tese nula $H_{0}$ foi rejeitada",
    "Hip√≥tese nula $H_{0}$ n√£o foi rejeitada")
colnames(cross.table.erros) <-
  c("Hip√≥tese nula $H_{0}$ √© falsa",
    "Hip√≥tese nula $H_{0}$ √© verdadeira")

# exibe a tabela de dados
knitr::kable(
  cross.table.erros,
  align = "c",
  format = ifelse(knitr::is_html_output(), "html", "latex"),
  booktabs = TRUE,
  linesep = "",
  escape = FALSE
) %>%
  kableExtra::kable_styling(
    latex_options = c("basic"),
    bootstrap_options = c("basic", "hover", "condensed", "responsive"),
    full_width = ifelse(knitr::is_html_output(), T, T),
    position = "center"
  ) %>%
  kableExtra::row_spec(0, bold = TRUE, extra_css = "border-top: 1px solid; border-bottom: 1px solid") %>%
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::row_spec(dim(cross.table.erros)[1], extra_css = "border-bottom: 1px solid")
```

<br>

```{r grafico-erro-tipo-I-II, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Representa√ß√£o gr√°fica dos erros tipo I e tipo II em um teste de hip√≥tese (bicaudal)."}
# Par√¢metros
mu0 <- 0
mu1 <- 1
sigma <- 1
alpha <- 0.05
z_crit <- stats::qnorm(1 - alpha, mean = mu0, sd = sigma)

# Dados principais
x <- base::seq(mu0 - 4 * sigma, mu1 + 4 * sigma, length.out = 1000)

dens_df <- dplyr::tibble(
  x = x,
  dens_H0 = stats::dnorm(x, mean = mu0, sd = sigma),
  dens_H1 = stats::dnorm(x, mean = mu1, sd = sigma)
)

# Dados das regi√µes de erro
area_alpha <- dplyr::filter(dens_df, x >= z_crit) %>%
  dplyr::mutate(erro = "Erro Tipo I (Œ±)", y = dens_H0)

area_beta <- dplyr::filter(dens_df, x <= z_crit) %>%
  dplyr::mutate(erro = "Erro Tipo II (Œ≤)", y = dens_H1)

areas_df <- dplyr::bind_rows(area_alpha, area_beta)

# Gr√°fico
plot_base <- ggplot2::ggplot() +
  # √Åreas de erro com legenda
  ggplot2::geom_area(data = areas_df,
                     ggplot2::aes(x = x, y = y, fill = erro),
                     alpha = 0.3) +
  # Curvas H0 e H1
  ggplot2::geom_line(data = dens_df,
                     ggplot2::aes(x = x, y = dens_H0, color = "H0"),
                     linewidth = 1.2) +
  ggplot2::geom_line(data = dens_df,
                     ggplot2::aes(x = x, y = dens_H1, color = "H1"),
                     linewidth = 1.2) +
  # Linhas verticais
  ggplot2::geom_vline(
    xintercept = z_crit,
    linetype = "dashed",
    color = "black",
    linewidth = 1
  ) +
  ggplot2::geom_vline(
    xintercept = mu0,
    linetype = "dotted",
    color = "blue",
    linewidth = 1
  ) +
  ggplot2::geom_vline(
    xintercept = mu1,
    linetype = "dotted",
    color = "red",
    linewidth = 1
  ) +
  # Anota√ß√µes matem√°ticas
  ggplot2::annotate(
    "text",
    x = z_crit + 0.1,
    y = 0.2,
    label = "z[alpha]",
    parse = TRUE,
    hjust = 0,
    color = "black"
  ) +
  ggplot2::annotate(
    "text",
    x = mu0,
    y = 0.3,
    label = "mu[0]",
    parse = TRUE,
    hjust = -0.1,
    color = "blue"
  ) +
  ggplot2::annotate(
    "text",
    x = mu1,
    y = 0.3,
    label = "mu[1]",
    parse = TRUE,
    hjust = -0.1,
    color = "red"
  ) +
  ggplot2::annotate(
    "text",
    x = z_crit + 0.1,
    y = 0.1,
    label = "alpha",
    parse = TRUE,
    hjust = 0,
    color = "blue"
  ) +
  ggplot2::annotate(
    "text",
    x = z_crit - 0.4,
    y = 0.05,
    label = "beta",
    parse = TRUE,
    hjust = 0,
    color = "red"
  ) +
  # T√≠tulos e legendas
  ggplot2::labs(
    title = "Erros tipo I (Œ±) e II (Œ≤)",
    x = "Efeito",
    y = "Densidade",
    color = "Distribui√ß√µes",
    fill = NULL  # Remove t√≠tulo da legenda de preenchimento
  ) +
  # Escalas de cores
  ggplot2::scale_color_manual(
    values = c("H0" = "blue", "H1" = "red"),
    labels = c(expression(H[0]), expression(H[1]))
  ) +
  ggplot2::scale_fill_manual(values = c(
    "Erro Tipo I (Œ±)" = "blue",
    "Erro Tipo II (Œ≤)" = "red"
  )) +
  ggplot2::theme_minimal(base_size = 14) +
  ggplot2::theme(legend.position = "bottom")

# Exibir gr√°fico
plot_base
```

<br>

```{r erro-tipo-I, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.cap = "Erro tipo I: Distribui√ß√£o dos p-valores em 100 testes de hip√≥tese de amostras aleat√≥rias de tamanho 30. A linha vermelha pontilhada indica o n√≠vel de signific√¢ncia estat√≠stica de 0,05.", fig.width=15, fig.height=4, out.width="100%"}
# Reprodutibilidade
set.seed(42)

# Par√¢metros da simula√ß√£o
n_tests <- 100  # N√∫mero de testes
n_samples <- 30  # Tamanho da amostra em cada teste

# Simular 100 testes com amostras de 30 elementos
p_values <- numeric(n_tests)  # Vetor para armazenar os p-valores

for (i in 1:n_tests) {
  # Gerar uma amostra aleat√≥ria de uma distribui√ß√£o normal
  sample_data <- rnorm(n_samples)
  
  # Realizar um teste t para a m√©dia da amostra (teste bilateral)
  test_result <- t.test(sample_data)
  
  # Armazenar o p-valor
  p_values[i] <- test_result$p.value
}

# Contar quantos p-valores s√£o menores que 0,05
p_less_than_0_05 <- sum(p_values < 0.05)

# Criar gr√°fico de distribui√ß√£o dos p-valores
ggplot2::ggplot(data.frame(p_values), ggplot2::aes(x = p_values)) +
  ggplot2::geom_histogram(binwidth = 0.01, fill = "lightblue", color = "black", alpha = 0.7) +
  ggplot2::geom_vline(xintercept = 0.05, color = "red", linetype = "dashed", size = 1) +
  ggplot2::annotate("text", x = 0.06, y = 15, label = "p < 0,05", color = "red", size = 5) +
  ggplot2::theme_minimal() +
  ggplot2::labs(
    title = expression("Distribui√ß√£o dos p-valores com H"[0]*" verdadeira"),
    subtitle = paste("N√∫mero de testes com p < 0,05 (erro tipo I):", p_less_than_0_05, "de", n_tests, "\n"),
    x = "P-valor",
    y = "Frequ√™ncia") +
  ggplot2::theme(axis.text = ggplot2::element_text(size = 12),
        axis.title = ggplot2::element_text(size = 14)) +
  ggplot2::scale_x_continuous(
  limits = c(0, 1),
  breaks = seq(0, 1, by = 0.25)
)
```

<br>

```{r erro-tipo-II, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.cap = "Erro tipo II: Distribui√ß√£o dos p-valores em 100 testes de hip√≥tese de amostras aleat√≥rias de tamanho 10. A linha vermelha pontilhada indica o n√≠vel de signific√¢ncia estat√≠stica de 0,05.", fig.width=15, fig.height=4, out.width="100%"}
# Reprodutibilidade
set.seed(42)

# Par√¢metros da simula√ß√£o
n_tests <- 100
n_samples <- 34  # Ajustado para obter ~80% de poder (20% de erro tipo II)
true_mean <- 0.5  # H‚ÇÄ √© falsa: m√©dia real ‚â† 0

# Vetor para armazenar p-valores
p_values <- numeric(n_tests)

for (i in 1:n_tests) {
  # Gerar amostra de uma normal com m√©dia ‚â† 0
  sample_data <- rnorm(n_samples, mean = true_mean, sd = 1)
  
  # Teste t contra H‚ÇÄ: mu = 0
  test_result <- t.test(sample_data, mu = 0)
  
  # Armazenar p-valor
  p_values[i] <- test_result$p.value
}

# Contar quantos testes N√ÉO rejeitaram H‚ÇÄ (erro tipo II)
p_greater_than_0_05 <- sum(p_values > 0.05)
erro_tipo_II_percentual <- round(p_greater_than_0_05 / n_tests * 100)

# Gr√°fico
ggplot2::ggplot(data.frame(p_values), ggplot2::aes(x = p_values)) +
  ggplot2::geom_histogram(binwidth = 0.01, fill = "lightcoral", color = "black", alpha = 0.7) +
  ggplot2::geom_vline(xintercept = 0.05, color = "red", linetype = "dashed", size = 1) +
  ggplot2::annotate("text", x = 0.25, y = 15,
                    label = paste0("Erro tipo II (p > 0,05): ", erro_tipo_II_percentual, "%"),
                    color = "red", size = 5) +
  ggplot2::theme_minimal() +
  ggplot2::labs(
    title = expression("Distribui√ß√£o dos p-valores com H"[0]*" falsa"),
    subtitle = paste("N√∫mero de testes com p > 0,05 (erro tipo II):", p_greater_than_0_05, "de", n_tests, "\n"),
    x = "P-valor",
    y = "Frequ√™ncia"
  ) +
  ggplot2::theme(axis.text = ggplot2::element_text(size = 12),
                 axis.title = ggplot2::element_text(size = 14)) +
  ggplot2::scale_x_continuous(
  limits = c(0, 1),
  breaks = seq(0, 1, by = 0.25)
)
```

<br>

### O que s√£o erros Tipo S e Tipo M?

-   Erro Tipo S (do ingl√™s *sign*) significa a identifica√ß√£o err√¥nea da dire√ß√£o --- positiva ou negativa --- do efeito observado.[@gelman2014; @lu2018]

<br>

```{r grafico-erro-tipo-S, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, tab.cap = "Tabela de erro tipo S de infer√™ncia estat√≠stica."}
# Cria uma tabela de erros tipo S
cross.table.erros <-
  matrix(
    c(
      'Decis√£o correta',
      'Decis√£o incorreta (erro tipo S)',
      'Decis√£o incorreta (erro tipo S)',
      'Decis√£o correta'
    ),
    nrow = 2,
    ncol = 2,
    byrow = FALSE
  )
rownames(cross.table.erros) <-
  c("Sinal positivo", "Sinal negativo")
colnames(cross.table.erros) <-
  c("Sinal positivo", "Sinal negativo")

# exibe a tabela de dados
knitr::kable(
  cross.table.erros,
  align = "c",
  format = ifelse(knitr::is_html_output(), "html", "latex"),
  booktabs = TRUE,
  linesep = "",
  escape = FALSE
) %>%
  kableExtra::kable_styling(
    latex_options = c("basic"),
    bootstrap_options = c("basic", "hover", "condensed", "responsive"),
    full_width = ifelse(knitr::is_html_output(), T, T),
    position = "center"
  ) %>%
  kableExtra::row_spec(0, bold = TRUE, extra_css = "border-top: 1px solid; border-bottom: 1px solid") %>%
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::row_spec(dim(cross.table.erros)[1], extra_css = "border-bottom: 1px solid")
```

<br>

```{r grafico-erro-tipo-S-bicaudal, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Representa√ß√£o gr√°fica do erro tipo S (sinal) em um teste de hip√≥tese (bicaudal)."}
# Reprodutibilidade
set.seed(123)

# Par√¢metros
mu0 <- 0
mu1 <- 0.2
sigma <- 1
alpha <- 0.05
n <- 30
se <- sigma / sqrt(n)

# Simula erro tipo-S
repeat {
  obs_mean <- rnorm(1, mean = mu1, sd = se)
  z <- (obs_mean - mu0) / se
  if (abs(z) > qnorm(1 - alpha / 2) && obs_mean < 0)
    break
}

# Dados
x <- seq(-1, 1, length.out = 1000)
dens_H0 <- dnorm(x, mean = mu0, sd = se)
dens_H1 <- dnorm(x, mean = mu1, sd = se)
dens_estimado <- dnorm(x, mean = obs_mean, sd = se)

dados <- data.frame(
  x = x,
  H0 = dens_H0,
  H1 = dens_H1,
  Estimado = dens_estimado
)

# Picos
pico_H1 <- dnorm(mu1, mean = mu1, sd = se)
pico_estimado <- dnorm(obs_mean, mean = obs_mean, sd = se)

# Limite superior do eixo y
y_lim_sup <- max(pico_H1, pico_estimado) + 0.15

plot_base <- ggplot2::ggplot(dados, ggplot2::aes(x = x)) +
  # Curvas
  ggplot2::geom_line(ggplot2::aes(y = H0, color = "H0"), size = 1) +
  ggplot2::geom_line(ggplot2::aes(y = H1, color = "H1"), size = 1) +
  ggplot2::geom_line(ggplot2::aes(y = Estimado, color = "Estimado"),
                     size = 1, linetype = "solid") +
  # Linhas principais
  ggplot2::geom_vline(xintercept = mu0, linetype = "dotted", color = "blue") +
  ggplot2::geom_vline(xintercept = mu1, linetype = "dotted", color = "red") +
  # Labels de m√©dias (CORRIGIDO: usar string + parse=TRUE)
  ggplot2::annotate(
    "text",
    x = mu0,
    y = max(dens_H0) * 0.95,
    label = "mu[0]",
    color = "blue",
    hjust = -0.1,
    parse = TRUE
  ) +
  ggplot2::annotate(
    "text",
    x = mu1,
    y = max(dens_H1) * 0.95,
    label = "mu[1]",
    color = "red",
    hjust = -0.1,
    parse = TRUE
  ) +
  # Seta "efeito real" no pico
  ggplot2::annotate(
    "segment",
    x = mu1, xend = mu1,
    y = y_lim_sup, yend = pico_H1,
    arrow = ggplot2::arrow(length = grid::unit(0.2, "cm")),
    color = "red"
  ) +
  ggplot2::annotate(
    "text",
    x = mu1, y = y_lim_sup + 0.05,
    label = "Real (+)", color = "red", hjust = 0.5
  ) +
  # Seta "efeito estimado" no pico
  ggplot2::annotate(
    "segment",
    x = obs_mean, xend = obs_mean,
    y = y_lim_sup, yend = pico_estimado,
    arrow = ggplot2::arrow(length = grid::unit(0.2, "cm")),
    color = "darkgreen"
  ) +
  ggplot2::annotate(
    "text",
    x = obs_mean, y = y_lim_sup + 0.05,
    label = "Estimado (-)", color = "darkgreen", hjust = 0.5
  ) +
  ggplot2::scale_color_manual(
    name = "Densidades",
    values = c("H0" = "blue", "H1" = "red", "Estimado" = "darkgreen")
  ) +
  ggplot2::labs(
    title = "Erro Tipo-S: Sinal Incorreto",
    x = "Efeito estimado", y = "Densidade"
  ) +
  ggplot2::coord_cartesian(xlim = c(-1, 1), ylim = c(0, y_lim_sup + 0.03)) +
  ggplot2::theme_minimal() +
  ggplot2::theme(legend.position = "none")

plot_base
```

<br>

-   Erro Tipo M (do ingl√™s *magnitude*) significa a identifica√ß√£o err√¥nea --- em geral, exagerada --- da magnitude do efeito observado.[@gelman2014; @lu2018]

<br>

```{r tabela-erro-tipo-M, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, tab.cap = "Tabela de erro tipo M de infer√™ncia estat√≠stica."}
# Cria uma tabela de erros tipo M
cross.table.erros <-
  matrix(
    c(
      'Decis√£o correta',
      'Decis√£o incorreta (erro tipo M)',
      'Decis√£o incorreta (erro tipo M)',
      'Decis√£o correta'
    ),
    nrow = 2,
    ncol = 2,
    byrow = FALSE
  )
rownames(cross.table.erros) <-
  c("Magnitude alta", "Magnitude baixa")
colnames(cross.table.erros) <-
  c("Magnitude alta", "Magnitude baixa")

# exibe a tabela de dados
knitr::kable(
  cross.table.erros,
  align = "c",
  format = ifelse(knitr::is_html_output(), "html", "latex"),
  booktabs = TRUE,
  linesep = "",
  escape = FALSE
) %>%
  kableExtra::kable_styling(
    latex_options = c("basic"),
    bootstrap_options = c("basic", "hover", "condensed", "responsive"),
    full_width = ifelse(knitr::is_html_output(), T, T),
    position = "center"
  ) %>%
  kableExtra::row_spec(0, bold = TRUE, extra_css = "border-top: 1px solid; border-bottom: 1px solid") %>%
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::row_spec(dim(cross.table.erros)[1], extra_css = "border-bottom: 1px solid")
```

<br>

```{r grafico-erro-tipo-M, echo = FALSE, warning = FALSE, message = FALSE, appendix = TRUE, fig.align = 'center', layout='Blank', ph=officer::ph_location_fullsize(), results = "asis", fig.fullwidth = TRUE, fig.cap = "Representa√ß√£o gr√°fica do erro tipo M (magnitude) em um teste de hip√≥tese (bicaudal)."}
# Reprodutibilidade
set.seed(123)

# Par√¢metros
mu0 <- 0
mu1 <- 0.2
sigma <- 1
alpha <- 0.05
n <- 30
se <- sigma / sqrt(n)

# Simula um efeito superestimado (erro tipo-M)
repeat {
  obs_mean <- rnorm(1, mean = mu1, sd = se)
  z <- (obs_mean - mu0) / se
  if (abs(z) > qnorm(1 - alpha / 2) && obs_mean > mu1)
    break
}

# Densidades para visualiza√ß√£o
x <- seq(-1, 1, length.out = 1000)
dens_H0 <- dnorm(x, mean = mu0, sd = se)
dens_H1 <- dnorm(x, mean = mu1, sd = se)
dens_estimado <- dnorm(x, mean = obs_mean, sd = se)

# Picos das curvas
pico_H1 <- dnorm(mu1, mean = mu1, sd = se)
pico_estimado <- dnorm(obs_mean, mean = obs_mean, sd = se)

# Limite superior do eixo y
y_lim_sup <- max(pico_H1, pico_estimado) + 0.15

# Dados para o gr√°fico
dados <- data.frame(
  x = x,
  H0 = dens_H0,
  H1 = dens_H1,
  Estimado = dens_estimado
)

# Gr√°fico
plot_base <- ggplot2::ggplot(dados, ggplot2::aes(x = x)) +
  ggplot2::geom_line(ggplot2::aes(y = H0, color = "H0"), size = 1) +
  ggplot2::geom_line(ggplot2::aes(y = H1, color = "H1"), size = 1) +
  ggplot2::geom_line(ggplot2::aes(y = Estimado, color = "Estimado"), size = 1) +
  ggplot2::geom_vline(xintercept = mu0, linetype = "dotted", color = "blue") +
  ggplot2::geom_vline(xintercept = mu1, linetype = "dotted", color = "red") +

  # >>> CORRE√á√ÉO AQUI: usar strings + parse=TRUE
  ggplot2::annotate(
    "text",
    x = mu0, y = max(dens_H0) * 0.95,
    label = "mu[0]", color = "blue", hjust = -0.1, parse = TRUE
  ) +
  ggplot2::annotate(
    "text",
    x = mu1, y = max(dens_H1) * 0.95,
    label = "mu[1]", color = "red", hjust = -0.1, parse = TRUE
  ) +

  # Setas e texto
  ggplot2::annotate(
    "segment",
    x = mu1, xend = mu1,
    y = y_lim_sup, yend = pico_H1,
    arrow = ggplot2::arrow(length = grid::unit(0.2, "cm")),
    color = "red"
  ) +
  ggplot2::annotate(
    "text",
    x = mu1, y = y_lim_sup + 0.05,
    label = "Real (+)", color = "red", hjust = 0.5
  ) +
  ggplot2::annotate(
    "segment",
    x = obs_mean, xend = obs_mean,
    y = y_lim_sup, yend = pico_estimado,
    arrow = ggplot2::arrow(length = grid::unit(0.2, "cm")),
    color = "darkgreen"
  ) +
  ggplot2::annotate(
    "text",
    x = obs_mean, y = y_lim_sup + 0.05,
    label = "Estimado (++)", color = "darkgreen", hjust = 0.5
  ) +
  ggplot2::scale_color_manual(
    name = "Densidades",
    values = c("H0" = "blue", "H1" = "red", "Estimado" = "darkgreen")
  ) +
  ggplot2::labs(
    title = "Erro Tipo-M: Superestima√ß√£o da Magnitude",
    x = "Efeito estimado", y = "Densidade"
  ) +
  ggplot2::coord_cartesian(xlim = c(-1, 1), ylim = c(0, y_lim_sup + 0.03)) +
  ggplot2::theme_minimal() +
  ggplot2::theme(legend.position = "none")

plot_base
```

<br>

```{r, echo=FALSE, warning=FALSE, results='asis', eval=knitr::is_html_output()}
cat(readLines("citation.html"), sep = "\n")
```

<br>
