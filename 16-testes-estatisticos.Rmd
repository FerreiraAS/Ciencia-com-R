# **Testes estatísticos** {#testes-estatisticos}

<br>

## Testes estatísticos para análise inferencial {#testes-analise-inferencial}

<br>

### Qui-quadrado ($\chi^2$)

-   O teste qui-quadrado ($\chi^2$) avalia uma hipótese global se a relação entre duas variáveis e/ou fatores é independente ou associada.[@Kim2017a]

-   O teste qui-quadrado é utilizado para comparar a distribuição de uma variável categórica em uma amostra ou grupo com a distribuição em outro. Se a distribuição da variável categórica não for muito diferente nos diferentes grupos, pode-se concluir que a distribuição da variável categórica não está relacionada com a variável dos grupos. Pode-se também concluir que a variável categórica e os grupos são independentes.[@Kim2017a]

-   Tipo: não paramétrico.[@McHugh2013; @Kim2017a]

-   Suposições:[@McHugh2013; @Kim2017a]

    -   As variáveis são ordinais ou categóricas nominais, de modo que as células representem frequência.

    -   Os níveis dos fatores (variáveis categóricas) são mutuamente exclusivos.

    -   Tamanho de amostra grande e adequado porque é baseado em uma abordagem de aproximação.

    -   Menos de 20% das células com frequências esperadas \< 5

    -   Nenhuma célula com frequência esperada \< 1.

-   Hipóteses:[@Kim2017a]

    -   Nula ($H_{0}$): independente (sem associação)

    -   Alternativa ($H_{1}$): não independente (associação)

-   Tamanho do efeito:[@Kim2017a]

    -   Phi ($\phi$), para tabelas de contingência 2x2

    -   Razão de chances ($RC$ ou $OR$), para tabelas de contingência 2x2

    -   Cramer V ($V$), para tabelas de contingência NxM

<br>

```{r, echo = TRUE, include = TRUE, results = "asis", warning = FALSE, message = FALSE, fig.align = 'center', tidy = TRUE}
# carrega os pacotes
library("dplyr")
library("gtsummary")

# tabela 2x2
tbl_cross <-
    # banco de dados
    trial %>%
    # cria a tabela de contingência
    gtsummary::tbl_cross(
        row = trt,
        col = response,
        statistic = "{n}",
        digits = 0,
        percent = "cell",
        margin = c("row", "column"),
        missing = "no",
        missing_text = "Dados perdidos",
        margin_text = "Total"
        ) %>%
    # calcula o p-valor do teste
    gtsummary::add_p(
        test = "chisq.test",
        pvalue_fun = function(x) style_pvalue(x, digits = 3)
        ) %>%
    gtsummary::modify_header(
        p.value = "**P-valor**"
        ) %>%
    # calcula o tamanho do efeito
    gtsummary::modify_table_styling(
        rows = NULL,
        footnote = as.character(rstatix::cramer_v(trt, response))
        ) %>%
    # formata o título em negrito
    gtsummary::bold_labels() %>%
    # cria título da tabela
    gtsummary::modify_caption(
        "Teste Qui-quadrado (com correção de Yates)"
        )

# exibe a tabela
tbl_cross %>%
  gtsummary::as_hux_table()
```

<br>

```{r, echo = TRUE, include = TRUE, results = "asis", warning = FALSE, message = FALSE, fig.align = 'center', tidy = TRUE}
# carrega os pacotes
library("dplyr")
library("gtsummary")

# tabela 2x2
tbl_cross <-
    # banco de dados
    trial %>%
    # cria a tabela de contingência
    gtsummary::tbl_cross(
        row = trt,
        col = response,
        statistic = "{n}",
        digits = 0,
        percent = "cell",
        margin = c("row", "column"),
        missing = "no",
        missing_text = "Dados perdidos",
        margin_text = "Total"
        ) %>%
    # calcula o p-valor do teste
    gtsummary::add_p(
        test = "chisq.test.no.correct",
        pvalue_fun = function(x) style_pvalue(x, digits = 3)
        ) %>%
    gtsummary::modify_header(
        p.value = "**P-valor**"
        ) %>%
    # calcula o tamanho do efeito
    gtsummary::modify_table_styling(
        rows = NULL,
        footnote = as.character(rstatix::cramer_v(trt, response))
        ) %>%
    # formata o título em negrito
    gtsummary::bold_labels() %>%
    # cria título da tabela
    gtsummary::modify_caption(
        "Teste Qui-quadrado"
        )

# exibe a tabela
tbl_cross %>%
  gtsummary::as_hux_table()
```

<br>

### Teste exato de Fisher

-   O teste exato de Fisher avalia a hipótese nula de independência aplicando a distribuição hipergeométrica dos números nas células da tabela.[@Kim2017a]

-   Hipóteses:[@McHugh2013; @Kim2017a]

    -   Nula ($H_{0}$): independente (sem associação)

    -   Alternativa ($H_{1}$): não independente (associação)

-   Tamanho do efeito:[@McHugh2013; @Kim2017a]

    -   Phi ($\phi$), para tabelas de contingência 2x2

    -   Razão de chances ($RC$ ou $OR$), para tabelas de contingência 2x2

    -   Cramer V ($V$), para tabelas de contingência NxM

<br>

::: blue
`r library(fontawesome); fa("r-project", margin_right = "0.1em")` O pacote *gtsummary*[@gtsummary] fornece a função *tbl_cross* para criar uma tabela NxM. [`r library(fontawesome); fa("up-right-from-square", margin_right = "0.1em")`](https://cran.r-project.org/web/packages/gtsummary/index.html)
:::

<br>

```{r, echo = TRUE, include = TRUE, results = "asis", warning = FALSE, message = FALSE, fig.align = 'center', tidy = TRUE}
# carrega os pacotes
library("dplyr")
library("gtsummary")

# tabela 2x2
tbl_cross <-
    # banco de dados
    trial %>%
    # cria a tabela de contingência
    gtsummary::tbl_cross(
        row = trt,
        col = response,
        statistic = "{n}",
        digits = 0,
        percent = "cell",
        margin = c("row", "column"),
        missing = "no",
        missing_text = "Dados perdidos",
        margin_text = "Total"
        ) %>%
    # calcula o p-valor do teste
    gtsummary::add_p(
        test = "fisher.test",
        pvalue_fun = function(x) style_pvalue(x, digits = 3)
        ) %>%
    gtsummary::modify_header(
        p.value = "**P-valor**"
        ) %>%
    # calcula o tamanho do efeito
    gtsummary::modify_table_styling(
        rows = NULL,
        footnote = as.character(rstatix::cramer_v(trt, response))
        ) %>%
    # formata o título em negrito
    gtsummary::bold_labels() %>%
    # cria título da tabela
    gtsummary::modify_caption(
        "Teste exato de Fisher"
        )

# exibe a tabela
tbl_cross %>%
  gtsummary::as_hux_table()
```

<br>
