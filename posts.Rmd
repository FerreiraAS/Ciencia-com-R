# CREATE POSTS

```{r post, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# delete .PNG files from posts folder
delete_files <- list.dirs("posts", full.names = TRUE)
unlink(delete_files, recursive = TRUE)
# create folder "posts"
dir.create("posts", showWarnings = FALSE)

# read bib file
bib <- RefManageR::ReadBib(file.path("./bib", "references.bib"))

# read TeX file
tex_data <- TeXCheckR::read_tex_document(
  file.path("./docs", "Ciencia-com-R.tex")
)
# source scripts
source(file.path("R", "tex_to_df.R"), local = knitr::knit_global())
df <- parse_tex_structure(tex_data)

# clean df
df <- df |>
  dplyr::filter(
    !is.na(graphic) |
      (
        !is.na(references) &
          !grepl("REF", item) &
          references != "REF" &
          item != ".\\textsuperscript{\\citeproc{ref-REF}{\\textbf{REF?}}}"
      )
  )

# save all posts
source(file.path("R", "savePost.R"), local = knitr::knit_global())
for (i in 1:nrow(df)) {
  # progress bar
  cat(paste0(round(i / nrow(df) * 100), '% completed'))
  SavePost_df(entry = df[i, ], bib = bib)
  if (i == nrow(df)) cat(': Done')
  else cat('\014')
}
```
